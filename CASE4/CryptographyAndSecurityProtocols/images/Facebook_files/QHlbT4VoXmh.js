if (self.CavalryLogger) { CavalryLogger.start_js(["tJJJr"]); }

__d("LSDict",["nativePromiseRegeneratorRuntime","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";e.exports=h;function g(a){a.tag="ls-array";return a}function h(a){var c=this,d=new Map([].concat(a||[]).map(function(a){var b=a[0];a=a[1];return[JSON.stringify(b),a]}));this.get=function(a){return d.get(JSON.stringify(a))};this.set=function(a,b){d.set(JSON.stringify(a),b);return c};this["delete"]=function(a){return d["delete"](JSON.stringify(a))};this.clear=function(){return d.clear()};this.forEach=function(a,b){return d.forEach(function(b,d){return a(b,JSON.parse(d),c)},b)};this._getSize=function(){return d.size};Object.defineProperties(this,{size:{get:function(){return d.size}}});this.has=function(a){return d.has(JSON.stringify(a))};this.entries=b("nativePromiseRegeneratorRuntime").mark(function a(){var c,e,f,g,h,i,j;return b("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c=d.entries(),e=Array.isArray(c),f=0,c=e?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 1:if(!e){a.next=7;break}if(!(f>=c.length)){a.next=4;break}return a.abrupt("break",18);case 4:g=c[f++];a.next=11;break;case 7:f=c.next();if(!f.done){a.next=10;break}return a.abrupt("break",18);case 10:g=f.value;case 11:h=g;i=h[0];j=h[1];a.next=16;return[JSON.parse(i),j];case 16:a.next=1;break;case 18:case"end":return a.stop()}},a,this)});this[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=this.entries;this.keys=function(){return g(Array.from(d.keys()).map(function(a){return JSON.parse(a)}))};this.values=d.values.bind(d)}h.fromObject=function(a){return new h(Object.entries(a))};h.shapeToRecord=function(a){return Array.from(a).reduce(function(a,c){var d=c[0];c=c[1];if(typeof d!=="string")throw b("unrecoverableViolation")("Cannot convert dicts with mixed keys to records","messenger_web_product");return babelHelpers["extends"]({},a,(a={},a[d]=c,a))},{})}}),null);
__d("LSJson",["bs_caml_int64","LSDict","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";f.stringify=h;var g=512;function h(a,c){c===void 0&&(c=0);if(c>g)throw b("unrecoverableViolation")("recursion limit exceeded","messenger_comet");if(typeof a==="string"||typeof a==="number"||typeof a==="boolean")return JSON.stringify(a);else if(a===void 0)return"null";else if(typeof a==="object")if(Array.isArray(a))return a.tag==="ls-array"?"["+a.map(function(a){return h(a,c+1)}).join(",")+"]":b("bs_caml_int64").to_string(a);else if(a instanceof b("LSDict"))return"{"+Array.from(a.entries()).map(function(a){var d=a[0];a=a[1];if(typeof d==="string")return JSON.stringify(d)+":"+h(a,c+1);else throw b("unrecoverableViolation")("key must be a string","messenger_comet")}).join(",")+"}";throw b("unrecoverableViolation")("type not supported: %s"+typeof a,"messenger_comet")}}),null);
__d("LSDbStorage",["IndexedDbKeyComparer","LSStorage","bs_caml_int64","clearTimeout","err","nativePromiseRegeneratorRuntime","recoverableViolation","setTimeout","unrecoverableViolation","BPlusTreeBase"],(function(a,b,c,d,e,f){"use strict";var g=function(a,c){return b("BPlusTreeBase")(b("IndexedDbKeyComparer"),16,{read:function(b){return a.read(c,b)},readExn:function(b){return a.readExn(c,b)},readHeader:function(){return a.readHeader(c)},remove:function(b){return a.remove(c,b)},write:function(b,d){return a.write(c,b,d)},writeHeader:function(b){return a.writeHeader(c,b)},writeNew:function(b){return a.writeNew(c,b)}})};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"Transaction has finished")||this}return b}(babelHelpers.wrapNativeSuper(Error));function h(a){if(!Array.isArray(a)||a.length!==2||a.some(function(a){return!Number.isInteger(a)}))throw b("unrecoverableViolation")("Expected int64","messenger_web_product");return b("bs_caml_int64").to_float(a)}function i(a,c){function d(c){if(c.done)return c.value;if(!(c.value instanceof Promise))throw b("unrecoverableViolation")("expected promise","messenger_web_product");return c.value.then(function(b){return d(a.next(b))})}return d(a.next(c))}function j(a){return{next:b("nativePromiseRegeneratorRuntime").mark(function c(d){var e;return b("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:e=a.next(d);case 1:if(!(e.value instanceof window.Promise)){b.next=9;break}b.t0=a;b.next=5;return e.value;case 5:b.t1=b.sent;e=b.t0.next.call(b.t0,b.t1);b.next=1;break;case 9:return b.abrupt("return",e);case 10:case"end":return b.stop()}},c,this)})}}function k(a){var b=j(a);return{next:function(a){function b(b){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a){return i(b.next(a))})}}function a(a,c,d){var e=b("LSStorage").searchKey.bind(null,d),f=Promise.resolve();function l(a,c,d,e,f){var h,j,k;return b("nativePromiseRegeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:h=a.table(d);j=e===void 0?g(h,c):g(h.index(e),c);l.next=4;return b("nativePromiseRegeneratorRuntime").awrap(i(j.getWithDefault(f,void 0)));case 4:k=l.sent;if(!(k===void 0)){l.next=7;break}return l.abrupt("return",void 0);case 7:return l.abrupt("return",i(h.readDataExn(c,k)));case 8:case"end":return l.stop()}},null,this)}function m(a,c,d,f,g){var h;return b("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("nativePromiseRegeneratorRuntime").awrap(l(a,c,d,f,g));case 2:h=i.sent;if(!(h===void 0)){i.next=5;break}return i.abrupt("return",void 0);case 5:return i.abrupt("return",e(d,h));case 6:case"end":return i.stop()}},null,this)}function n(a,c,d,e,f,h){return k(b("nativePromiseRegeneratorRuntime").mark(function i(){var k,l,m,n,o,p,q;return b("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:k=a.table(d);k.readHeader(c);l=e===void 0?g(k,c):g(k.index(e),c);m=j(l.entries(babelHelpers["extends"]({},h,{dir:f})));return b.delegateYield(m.next(),"t0",5);case 5:n=b.t0;case 6:if(n.done){b.next=19;break}o=n.value,p=o[0],q=o[1];b.t1=m;b.t2=p;return b.delegateYield(k.readDataExn(c,q),"t3",11);case 11:b.t4=b.t3;b.next=14;return[b.t2,b.t4];case 14:b.t5=b.sent;return b.delegateYield(b.t1.next.call(b.t1,b.t5),"t6",16);case 16:n=b.t6;b.next=6;break;case 19:case"end":return b.stop()}},i,this)})())}function o(a,c,e){var f,g;return b("nativePromiseRegeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=d.tableNames[e].autoIncrement;if(f){h.next=3;break}throw b("unrecoverableViolation")("only supported for auto-incrementing tables","messenger_web_product");case 3:h.next=5;return b("nativePromiseRegeneratorRuntime").awrap(i(a.table(e).readSeed(c)));case 5:g=h.sent;if(!(g===void 0)){h.next=8;break}throw b("unrecoverableViolation")("unexpected undefined autoIncrementSeed","messenger_web_product");case 8:return h.abrupt("return",b("bs_caml_int64").of_float(g));case 9:case"end":return h.stop()}},null,this)}function p(a,c){function f(a,b,d,e){a=JSON.stringify([a,b]);b=c.get(a);c.set(a,[b==null?d:b[0],e])}function j(c,f,g,h){var i,j,k,l,m,o,r,s,t,u;return b("nativePromiseRegeneratorRuntime").async(function(v){while(1)switch(v.prev=v.next){case 0:i=function(a,b){var c=[],d=a;while(d!==0)c.push(d.hd),d=d.tl;return c.length>=b?a:c.reduceRight(function(a,b){return{hd:b,tl:a}},{hd:[[]],tl:0})};if(!(h!=null&&b("IndexedDbKeyComparer")(g,h)===0)){v.next=3;break}return v.abrupt("return");case 3:(j=d.tableNames[f],k=j.cascadeUpdates,l=j.primaryKeyIds),m=function(){var j,k,f,m,u,v,w,x,y,z,A,B,C,D,E;return b("nativePromiseRegeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:if(!r){F.next=6;break}if(!(s>=o.length)){F.next=3;break}return F.abrupt("return","break");case 3:t=o[s++];F.next=10;break;case 6:s=o.next();if(!s.done){F.next=9;break}return F.abrupt("return","break");case 9:t=s.value;case 10:j=t;k=j.indexName;f=j.tableName;m=d.tableNames[f],u=m.indexes,v=m.primaryKeyIds;w=k==null?v:u[k].keyIds;x={gte:g,lte:i(g,w.length)};y=n(a,c,f,k,"asc",x);F.next=19;return b("nativePromiseRegeneratorRuntime").awrap(y.next());case 19:z=F.sent,A=[];case 21:if(z.done){F.next=28;break}A.push(z.value);F.next=25;return b("nativePromiseRegeneratorRuntime").awrap(y.next());case 25:z=F.sent;F.next=21;break;case 28:B=0;case 29:if(!(B<A.length)){F.next=44;break}C=A[B];C[0];D=C[1];E=e(f,D);if(!(h===void 0)){F.next=39;break}F.next=37;return b("nativePromiseRegeneratorRuntime").awrap(q(c,f,E));case 37:F.next=41;break;case 39:F.next=41;return b("nativePromiseRegeneratorRuntime").awrap(p(c,f,E,l.reduce(function(a,b,c){b=a[0];a=a[1];if(!a)return[b,a];b[w[c]]=a.hd;return[b,a.tl]},[babelHelpers["extends"]({},D),h])[0]));case 41:B++;F.next=29;break;case 44:case"end":return F.stop()}},null,this)},(o=k,r=Array.isArray(o),s=0,o=r?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 6:v.next=8;return b("nativePromiseRegeneratorRuntime").awrap(m());case 8:u=v.sent;if(!(u==="break")){v.next=11;break}return v.abrupt("break",13);case 11:v.next=6;break;case 13:case"end":return v.stop()}},null,this)}function k(c,h,j){var k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;return b("nativePromiseRegeneratorRuntime").async(function(K){while(1)switch(K.prev=K.next){case 0:k=a.table(h);l=g(k,c);m=d.tableNames[h];n=e(h,j);o=Object.keys(m.indexes).reduce(function(b,c){var a=e(h,j,c);a!=null&&(b[c]=a);return b},{});p={};K.next=8;return b("nativePromiseRegeneratorRuntime").awrap(i(l.getWithDefault(n,void 0)));case 8:r=K.sent;if(!(r!==void 0)){K.next=18;break}K.next=12;return b("nativePromiseRegeneratorRuntime").awrap(i(k.readDataExn(c,r)));case 12:s=K.sent;Object.keys(m.indexes).length&&(p=Object.keys(m.indexes).reduce(function(b,c){var a=e(h,s,c);a!=null&&(b[c]=a);return b},{}));K.next=16;return b("nativePromiseRegeneratorRuntime").awrap(i(k.writeData(c,r,j)));case 16:K.next=25;break;case 18:if(!m.autoIncrement){K.next=20;break}throw b("unrecoverableViolation")("Id must not be specified for new record when table has an autoincrementing primary key","messenger_web_product");case 20:K.next=22;return b("nativePromiseRegeneratorRuntime").awrap(i(k.writeNewData(c,j)));case 22:r=K.sent;K.next=25;return b("nativePromiseRegeneratorRuntime").awrap(i(l.set(n,r)));case 25:t=Object.keys(o);for(u=0;u<t.length;u++)v=t[u],p[v]!==void 0&&b("IndexedDbKeyComparer")(p[v],o[v])===0&&(delete o[v],delete p[v]);w=new Set();x=Object.keys(o);y=0;case 30:if(!(y<x.length)){K.next=54;break}z=x[y];A=g(k.index(z),c);K.next=35;return b("nativePromiseRegeneratorRuntime").awrap(i(A.getWithDefault(o[z])));case 35:B=K.sent;if(!(B!=null&&!w.has(B))){K.next=51;break}K.t0=b("nativePromiseRegeneratorRuntime");K.t1=q;K.t2=c;K.t3=h;K.t4=e;K.t5=h;K.next=45;return b("nativePromiseRegeneratorRuntime").awrap(i(k.readDataExn(c,B)));case 45:K.t6=K.sent;K.t7=K.t4(K.t5,K.t6);K.t8=K.t1(K.t2,K.t3,K.t7);K.next=50;return K.t0.awrap.call(K.t0,K.t8);case 50:w.add(B);case 51:y++;K.next=30;break;case 54:C=Object.keys(o),D=0;case 56:if(!(D<C.length)){K.next=64;break}E=C[D];F=g(k.index(E),c);K.next=61;return b("nativePromiseRegeneratorRuntime").awrap(i(F.set(o[E],r)));case 61:D++;K.next=56;break;case 64:G=Object.keys(p),H=0;case 66:if(!(H<G.length)){K.next=74;break}I=G[H];J=g(k.index(I),c);K.next=71;return b("nativePromiseRegeneratorRuntime").awrap(i(J["delete"](p[I])));case 71:H++;K.next=66;break;case 74:f(h,n,s,j);case 75:case"end":return K.stop()}},null,this)}function p(a,c,d,f){var g;return b("nativePromiseRegeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:g=e(c,f);if(b("LSStorage").areKeysEqual(d,g)){h.next=4;break}h.next=4;return b("nativePromiseRegeneratorRuntime").awrap(q(a,c,d));case 4:h.next=6;return b("nativePromiseRegeneratorRuntime").awrap(k(a,c,f));case 6:case"end":return h.stop()}},null,this)}function q(c,h,j){var k,l,m,n,o,p,q,r,s,t;return b("nativePromiseRegeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:k=a.table(h);l=g(k,c);m=d.tableNames[h];u.next=5;return b("nativePromiseRegeneratorRuntime").awrap(i(l.getWithDefault(j,void 0)));case 5:n=u.sent;if(!(n!==void 0)){u.next=28;break}u.next=9;return b("nativePromiseRegeneratorRuntime").awrap(i(k.readDataExn(c,n)));case 9:o=u.sent;if(!Object.keys(m.indexes).length){u.next=23;break}p=Object.keys(m.indexes);q=0;case 13:if(!(q<p.length)){u.next=23;break}r=p[q];s=e(h,o,r);if(!(s!=null)){u.next=20;break}t=g(k.index(r),c);u.next=20;return b("nativePromiseRegeneratorRuntime").awrap(i(t["delete"](s)));case 20:q++;u.next=13;break;case 23:u.next=25;return b("nativePromiseRegeneratorRuntime").awrap(i(l["delete"](j)));case 25:u.next=27;return b("nativePromiseRegeneratorRuntime").awrap(i(k.remove(c,n)));case 27:f(h,j,o,void 0);case 28:case"end":return u.stop()}},null,this)}function r(c,j,k){var l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E;return b("nativePromiseRegeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:l=a.table(j);m=g(l,c);n=d.tableNames[j];if(!n.autoIncrement){F.next=11;break}o=k[d.tableNames[j].primaryKeyIds[0]];F.t0=b("bs_caml_int64");F.next=8;return b("nativePromiseRegeneratorRuntime").awrap(i(l.incrementSeed(c,o===void 0?o:h(o))));case 8:F.t1=F.sent,p=F.t0.of_float.call(F.t0,F.t1),k[d.tableNames[j].primaryKeyIds[0]]=p;case 11:r=e(j,k);if(!(r==null)){F.next=14;break}throw new Error("Evaluating the object store's key path did not yield a value");case 14:F.next=16;return b("nativePromiseRegeneratorRuntime").awrap(i(m.has(r)));case 16:if(F.sent){F.next=64;break}s=Object.keys(n.indexes);t=0;case 19:if(!(t<s.length)){F.next=46;break}u=s[t];v=e(j,k,u);w=new Set();if(!(v!=null)){F.next=43;break}x=g(l.index(u),c);F.next=27;return b("nativePromiseRegeneratorRuntime").awrap(i(x.getWithDefault(v)));case 27:y=F.sent;if(!(y!=null&&!w.has(y))){F.next=43;break}F.t2=b("nativePromiseRegeneratorRuntime");F.t3=q;F.t4=c;F.t5=j;F.t6=e;F.t7=j;F.next=37;return b("nativePromiseRegeneratorRuntime").awrap(i(l.readDataExn(c,y)));case 37:F.t8=F.sent;F.t9=F.t6(F.t7,F.t8);F.t10=F.t3(F.t4,F.t5,F.t9);F.next=42;return F.t2.awrap.call(F.t2,F.t10);case 42:w.add(y);case 43:t++;F.next=19;break;case 46:F.next=48;return b("nativePromiseRegeneratorRuntime").awrap(i(l.writeNewData(c,k)));case 48:z=F.sent;F.next=51;return b("nativePromiseRegeneratorRuntime").awrap(i(m.set(r,z)));case 51:A=Object.keys(n.indexes),B=0;case 53:if(!(B<A.length)){F.next=63;break}C=A[B];D=e(j,k,C);if(!(D!=null)){F.next=60;break}E=g(l.index(C),c);F.next=60;return b("nativePromiseRegeneratorRuntime").awrap(i(E.set(D,z)));case 60:B++;F.next=53;break;case 63:f(j,r,void 0,k);case 64:case"end":return F.stop()}},null,this)}return{table:function(c){return{put:function(a){var d;return b("nativePromiseRegeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=new WeakMap();f.next=3;return b("nativePromiseRegeneratorRuntime").awrap(k(d,c,a));case 3:f.next=5;return b("nativePromiseRegeneratorRuntime").awrap(j(d,c,e(c,a)));case 5:case"end":return f.stop()}},null,this)},upsert:function(a,d){var f;return b("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:f=new WeakMap();g.next=3;return b("nativePromiseRegeneratorRuntime").awrap(p(f,c,a,d));case 3:g.next=5;return b("nativePromiseRegeneratorRuntime").awrap(j(f,c,a,e(c,d)));case 5:case"end":return g.stop()}},null,this)},"delete":function(a){var d;return b("nativePromiseRegeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=new WeakMap();e.next=3;return b("nativePromiseRegeneratorRuntime").awrap(q(d,c,a));case 3:e.next=5;return b("nativePromiseRegeneratorRuntime").awrap(j(d,c,a));case 5:case"end":return e.stop()}},null,this)},add:function(a){return r(new WeakMap(),c,a)},get:function(b,d){d===void 0&&(d=new WeakMap());return l(a,d,c,void 0,b)},entries:function(b,d,e){d===void 0&&(d="asc");e===void 0&&(e={});return n(a,b,c,void 0,d,e)},peekNextAutoIncrementId:function(){return o(a,new WeakMap(),c)},index:function(b){return{get:function(d){return l(a,new WeakMap(),c,b,d)},getKey:function(d){return m(a,new WeakMap(),c,b,d)},entries:function(d,e,f){e===void 0&&(e="asc");f===void 0&&(f={});return n(a,d,c,b,e,f)}}}}}}}return{getTableData:function(){return d},runInTransaction:function(d,e){var g=b("err")(""),h=new Map();return new Promise(function(e,i){f=f.then(function(){var f,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y;return b("nativePromiseRegeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:f={codeRan:!1,transactionFlushed:!1,totalEvents:-1,eventsEmitted:-1,lastEventEmittedTableName:null,transactionSuccess:null};j=b("setTimeout")(function(){b("recoverableViolation")("Transaction took more than 5 seconds to execute. "+JSON.stringify(f),"messenger_web_product",{error:g})},5e3);z.prev=2;k=a.createTransaction();z.next=6;return b("nativePromiseRegeneratorRuntime").awrap(d(p(k,h)));case 6:l=z.sent;f.codeRan=!0;m=new WeakMap();z.next=11;return b("nativePromiseRegeneratorRuntime").awrap(k.flush());case 11:f.transactionFlushed=!0,f.totalEvents=h.size,f.eventsEmitted=0,(n=h,o=Array.isArray(n),q=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 15:if(!o){z.next=21;break}if(!(q>=n.length)){z.next=18;break}return z.abrupt("break",37);case 18:r=n[q++];z.next=25;break;case 21:q=n.next();if(!q.done){z.next=24;break}return z.abrupt("break",37);case 24:r=q.value;case 25:s=r;t=s[0];u=s[1];v=u[0];w=u[1];x=JSON.parse(t),y=x[0],x[1];z.next=33;return b("nativePromiseRegeneratorRuntime").awrap(c.notifyTableAndIndexSubscribers(y,v,w,m));case 33:f.eventsEmitted++,f.lastEventEmittedTableName=y;case 35:z.next=15;break;case 37:f.transactionSuccess=!0;e(l);z.next=45;break;case 41:z.prev=41,z.t0=z["catch"](2),f.transactionSuccess=!1,i(z.t0);case 45:b("clearTimeout")(j),c.notifyCommit();case 47:case"end":return z.stop()}},null,this,[[2,41]])})})},subscribeToCommit:function(a){return c.subscribeToCommit(a)},table:function(b){return{get:function(c,d){d===void 0&&(d=new WeakMap());return l(a.createTransaction(),d,b,void 0,c)},entries:function(c,d,e){d===void 0&&(d="asc");e===void 0&&(e={});return n(a.createTransaction(),c,b,void 0,d,e)},peekNextAutoIncrementId:function(){return o(a.createTransaction(),new WeakMap(),b)},subscribe:function(){for(var a=arguments.length,d=new Array(a),e=0;e<a;e++)d[e]=arguments[e];return c.subscribeTable.apply(c,[b].concat(d))},index:function(d){return{get:function(c,e){e===void 0&&(e=new WeakMap());return l(a.createTransaction(),e,b,d,c)},getKey:function(c){return m(a.createTransaction(),new WeakMap(),b,d,c)},entries:function(c,e,f){e===void 0&&(e="asc");f===void 0&&(f={});return n(a.createTransaction(),c,b,d,e,f)},subscribe:function(){for(var a=arguments.length,e=new Array(a),f=0;f<a;f++)e[f]=arguments[f];return c.subscribeIndex.apply(c,[b,d].concat(e))}}}}},subscriptionManager:c,clearCacheIfSupported:function(){var b=a;b instanceof Object&&b.clearCache!==void 0&&b.clearCache instanceof Function&&b.clearCache()}}}d=Object.assign(a,c);e.exports=d}),null);
__d("MPWLSDBCreateSchema.bs",["bs_js_dict","LSMetadata","LSTableSchemas","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";c=b("LSMetadata").buildMetadata(b("LSTableSchemas"));function a(a,c,d,e,f){f=b("bs_js_dict").get(a.tableNames,d);if(f!==void 0){f.cascadeUpdates.push({tableName:c,indexName:e});return}else return b("unrecoverableViolation")("Failed to add foreign key","messenger_comet")}a(c,"attachments","messages","fk_messages",void 0);a(c,"messages","threads",void 0,void 0);a(c,"thread_nullstate","threads",void 0,void 0);a(c,"participants","threads",void 0,void 0);f.metadata=c;f.addForeignKey=a}),null);
__d("MemoryDbStore",["regeneratorRuntime","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g={};function h(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=Array.isArray(e)?[].concat(e):e;return a}function i(a,c){var d=c===void 0?"root":"index("+c+")";return{read:b("regeneratorRuntime").mark(function c(d,e){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:return b.abrupt("return",a.get(e));case 1:case"end":return b.stop()}},c,this)}),readExn:b("regeneratorRuntime").mark(function c(d,e){return b("regeneratorRuntime").wrap(function(c){while(1)switch(c.prev=c.next){case 0:if(a.has(e)){c.next=2;break}throw b("unrecoverableViolation")("expected key","messenger_web_product");case 2:return c.abrupt("return",a.get(e));case 3:case"end":return c.stop()}},c,this)}),readHeader:b("regeneratorRuntime").mark(function c(e){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:return b.abrupt("return",a.get(d));case 1:case"end":return b.stop()}},c,this)}),remove:b("regeneratorRuntime").mark(function c(d,e){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:a["delete"](e);case 1:case"end":return b.stop()}},c,this)}),write:b("regeneratorRuntime").mark(function c(d,e,f){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:a.put(e,f);case 1:case"end":return b.stop()}},c,this)}),writeHeader:b("regeneratorRuntime").mark(function c(e,f){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:a.put(d,f);case 1:case"end":return b.stop()}},c,this)}),writeNew:b("regeneratorRuntime").mark(function c(d,e){return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:return b.abrupt("return",a.add(e));case 1:case"end":return b.stop()}},c,this)})}}function j(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(){var a=new Map();return{createTransaction:function(){var c=new Map();function d(b){return j(a,b,function(){return{data:new Map(),seed:0}})}return{flush:function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:c.forEach(function(a,b){var c=a.data;a=a.seed;var e=d(b);c.forEach(function(a,b){a===g?e.data["delete"](b):e.data.set(b,a)});e.seed=a});case 1:case"end":return a.stop()}},null,this)},table:function(a){var e=d(a),f=j(c,a,function(){return{data:new Map(),seed:e.seed}}),k={add:function(a){f.data.set(f.seed,a);f.seed++;return f.seed-1},"delete":function(a){f.data.set(a,g)},get:function(a){if(!f.data.has(a))return e.data.get(a);a=f.data.get(a);return a===g?void 0:a},has:function(a){return f.data.has(a)&&f.data.get(a)!==g||e.data.has(a)},put:function(a,b){f.data.set(a,b)}};return babelHelpers["extends"]({},i(k),{readDataExn:(a=b("regeneratorRuntime")).mark(function a(c,d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(k.has(d)){a.next=2;break}throw b("unrecoverableViolation")("expected key","messenger_web_product");case 2:return a.abrupt("return",k.get(d));case 3:case"end":return a.stop()}},a,this)}),writeData:a.mark(function a(c,d,e){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:k.put(d,h(e));case 1:case"end":return a.stop()}},a,this)}),writeNewData:a.mark(function a(c,d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",k.add(h(d)));case 1:case"end":return a.stop()}},a,this)}),incrementSeed:a.mark(function a(c,d){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:c=Math.max(k.get("seed")||0,d||0);k.put("seed",c+1);return a.abrupt("return",d===void 0?c:d);case 3:case"end":return a.stop()}},a,this)}),index:function(a){return i(k,a)},readSeed:a.mark(function a(c){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",k.get("seed")||0);case 1:case"end":return a.stop()}},a,this)})})}}}}}}),null);
__d("LSJSTestMemoryStorage.bs",["LSStorage","LSDbStorage","MemoryDbStore","MPWLSDBCreateSchema.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("LSDbStorage")(b("MemoryDbStore")(),b("LSStorage").createSubscriptionManager(b("MPWLSDBCreateSchema.bs").metadata),a)}f.make=a}),null);
__d("LSTransaction.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){return a.runInTransaction(b,function(){switch(c){case"readOnly":return"readonly";case"readWrite":return"readwrite"}}())}f.run=a}),null);
__d("LSDatabaseType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";c=(a=b("bs_caml_int64")).zero;d=a.one;e=a.mk(2,0);b=a.mk(3,0);var g=a.mk(4,0),h=a.mk(5,0),i=a.mk(6,0),j=a.mk(7,0),k=a.mk(8,0),l=a.mk(9,0),m=a.mk(10,0),n=a.mk(11,0),o=a.mk(12,0),p=a.mk(13,0),q=a.mk(14,0),r=a.mk(15,0),s=a.mk(16,0),t=a.mk(17,0),u=a.mk(18,0),v=a.mk(19,0),w=a.mk(20,0),x=a.mk(21,0),y=a.mk(22,0),z=a.mk(23,0),A=a.mk(24,0),B=a.mk(25,0),C=a.mk(26,0),D=a.mk(27,0),E=a.mk(28,0),F=a.mk(29,0),G=a.mk(30,0),H=a.mk(31,0),I=a.mk(32,0),J=a.mk(33,0),K=a.mk(34,0),L=a.mk(35,0),M=a.mk(36,0),N=a.mk(37,0),O=a.mk(38,0),P=a.mk(39,0),Q=a.mk(40,0),R=a.mk(41,0),S=a.mk(42,0),T=a.mk(43,0),U=a.mk(44,0),V=a.mk(45,0),W=a.mk(46,0),X=a.mk(47,0),Y=a.mk(48,0),Z=a.mk(49,0),$=a.mk(50,0),aa=a.mk(51,0),ba=a.mk(52,0),ca=a.mk(53,0),da=a.mk(54,0),ea=a.mk(55,0),fa=a.mk(56,0),ga=a.mk(57,0),ha=a.mk(59,0),ia=a.mk(60,0),ja=a.mk(61,0),ka=a.mk(62,0),la=a.mk(63,0),ma=a.mk(64,0),na=a.mk(65,0),oa=a.mk(66,0),pa=a.mk(67,0),qa=a.mk(68,0),ra=a.mk(69,0),sa=a.mk(70,0),ta=a.mk(71,0),ua=a.mk(72,0),va=a.mk(73,0),wa=a.mk(74,0),xa=a.mk(75,0),ya=a.mk(76,0),za=a.mk(77,0),Aa=a.mk(78,0),Ba=a.mk(79,0),Ca=a.mk(80,0);a=a.mk(81,0);f.test=c;f.mailbox=d;f.contact=e;f.appAlerts=b;f.core=g;f.stories=h;f.presence=i;f.ranking=j;f.experiment=k;f.search=l;f.securemailbox=m;f.inboxAds=n;f.sticker=o;f.omnistoreRevisionTest=p;f.frx=q;f.payments=r;f.settings=s;f.gif=t;f.arEffects=u;f.platformExtensionSdk=v;f.businessTab=w;f.composerMenus=x;f.experimentalContactPhoneNumber=y;f.forwardContents=z;f.typing=A;f.qp=B;f.inthreadbanner=C;f.logSampling=D;f.threadTheme=E;f.mediaSend=F;f.contactUpload=G;f.aloha=H;f.omnistoreSimpleTest=I;f.booking=J;f.oneTimeSyncTest=K;f.threadEmoji=L;f.universalLinks=M;f.counters=N;f.emptyTest=O;f.accountSettings=P;f.videoChatLink=Q;f.zeroRating=R;f.connectivity=S;f.switchAccountBadging=T;f.emergencyPoll=U;f.cowatch=V;f.switchAccountProfiles=W;f.$$location=X;f.syncWatchdog=Y;f.bloks=Z;f.mediaEditing=$;f.pushNotifications=aa;f.switchAccountBadgingRealtime=ba;f.dasmDebug=ca;f.testTwo=da;f.dataTrace=ea;f.mediaSharing=fa;f.pluginExtensions=ga;f.localUserSettings=ha;f.groups=ia;f.dabl=ja;f.linkedGroups=ka;f.fxcal=la;f.rooms=ma;f.proactiveWarnings=na;f.messagingAds=oa;f.supportInbox=pa;f.coreClient=qa;f.threadCoPresence=ra;f.marketplace=sa;f.carrierMessaging=ta;f.notificationsClient=ua;f.cat=va;f.composerSettings=wa;f.groupThreadImage=xa;f.coplayMetadata=ya;f.searchUserGroups=za;f.tutorial=Aa;f.paidAds=Ba;f.avatarsCoPresence=Ca;f.graphql=a}),null);
__d("LSSyncChannel.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=b("bs_caml_int64").mk(2,0);f.realtime=a;f.http=c}),null);
__d("LSMailboxInitialSyncCursor.bs",["LSSyncChannel.bs"],(function(a,b,c,d,e,f){"use strict";a={scale:1,preview_height:200,preview_width:150,full_height:200,snapshot_num_threads_per_page:15};c={contents:void 0};d={contents:b("LSSyncChannel.bs").realtime};e={contents:0};b={contents:a};f.defaultSyncParams=a;f.epochId=c;f.syncChannel=d;f.lastSyncTimestampMs=e;f.syncParams=b}),null);
__d("MWLSDatabaseInitialData.bs",["bs_curry","LSDict","LSJson","SkytaleDB","bs_caml_int64","bs_caml_format","CurrentUser","LSSyncChannel.bs","LSDatabaseType.bs","LSMailboxInitialSyncCursor.bs"],(function(a,b,c,d,e,f){"use strict";function g(a,b){return b.reduce(function(b,c){return b.then(function(b){return a.put(c)})},window.Promise.resolve(void 0))}function h(a){var c=b("LSJson").stringify(new(b("LSDict"))([]));return[function(c){var d;return g(b("SkytaleDB").table(a,"network_requests"),[{a:"",b:(c=b("LSDatabaseType.bs")).mailbox,c:b("LSMailboxInitialSyncCursor.bs").epochId.contents,d:void 0,e:(d=b("bs_caml_int64")).zero,f:d.zero,g:d.of_float(b("LSMailboxInitialSyncCursor.bs").lastSyncTimestampMs.contents),h:void 0},{a:"",b:c.contact,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0},{a:"",b:c.presence,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0},{a:"",b:c.payments,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0},{a:"",b:c.threadTheme,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0},{a:"",b:c.sticker,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0},{a:"",b:c.settings,c:void 0,d:void 0,e:d.zero,f:d.zero,g:d.zero,h:void 0}])},function(d){var e,f;return g(b("SkytaleDB").table(a,"sync_groups"),[{a:(d=b("LSDatabaseType.bs")).mailbox,b:void 0,c:(e=b("bs_caml_int64")).zero,d:JSON.stringify(b("LSMailboxInitialSyncCursor.bs").syncParams.contents),e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.of_float(b("LSMailboxInitialSyncCursor.bs").lastSyncTimestampMs.contents),j:void 0,k:void 0,l:void 0,m:void 0,n:b("LSMailboxInitialSyncCursor.bs").syncChannel.contents},{a:d.contact,b:void 0,c:e.zero,d:c,e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:(f=b("LSSyncChannel.bs")).realtime},{a:d.presence,b:void 0,c:e.zero,d:c,e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.payments,b:void 0,c:e.zero,d:c,e:!0,f:e.mk(1316134911,2328),g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.threadTheme,b:void 0,c:e.zero,d:c,e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.sticker,b:void 0,c:e.zero,d:c,e:!0,f:e.mk(1316134911,2328),g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.ranking,b:void 0,c:e.zero,d:c,e:!0,f:e.mk(1316134911,2328),g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.cat,b:void 0,c:e.zero,d:c,e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime},{a:d.settings,b:void 0,c:e.zero,d:c,e:!0,f:e.neg_one,g:!1,h:e.zero,i:e.zero,j:void 0,k:void 0,l:void 0,m:void 0,n:f.realtime}])},function(c){return g(b("SkytaleDB").table(a,"_user_info"),[{a:b("bs_caml_int64").one,b:b("bs_caml_format").caml_int64_of_string(b("CurrentUser").getID())}])}]}function a(a){return h(a).reduce(function(a,c){return a.then(b("bs_curry").__1(c))},window.Promise.resolve(void 0))}f.writeRows=g;f.writeData=h;f.run=a}),null);
__d("MWLSSchemaEphemeral.bs",["Promise","LSTransaction.bs","MPWLSDBCreateSchema.bs","LSJSTestMemoryStorage.bs","MWLSDatabaseInitialData.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("Promise").resolve(b("LSJSTestMemoryStorage.bs").make(b("MPWLSDBCreateSchema.bs").metadata)).then(function(a){return b("LSTransaction.bs").run(a,b("MWLSDatabaseInitialData.bs").run,"readWrite").then(function(b){return a})})}f.createDB=a}),null);