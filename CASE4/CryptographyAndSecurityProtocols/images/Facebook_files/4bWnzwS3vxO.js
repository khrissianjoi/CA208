if (self.CavalryLogger) { CavalryLogger.start_js(["wpX4a"]); }

__d("FBStoriesPrivacyChangeSubscription.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{kind:"Variable",name:"data",variableName:"input"}],c={alias:null,args:null,kind:"ScalarField",name:"audience_mode",storageKey:null},d=[{kind:"Literal",name:"first",value:5e3}],e={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},h={alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_viewer_friend",storageKey:null}],type:"User",abstractKey:null},j=[e,{alias:null,args:null,concreteType:"UnifiedStoriesParticipant",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[f,g,h,i],storageKey:null}],storageKey:null}],k={alias:null,args:null,concreteType:"UnifiedStoriesAudienceModeFormatData",kind:"LinkedField",name:"audience_mode_list",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"unified_stories_audience_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],storageKey:null};e=[e,{alias:null,args:null,concreteType:"UnifiedStoriesParticipant",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},f,g,h,i],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FBStoriesPrivacyChangeSubscription",selections:[{alias:null,args:b,concreteType:"UnifiedStoriesPrivacyChangeSubscribeResponsePayload",kind:"LinkedField",name:"unified_stories_privacy_change_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UnifiedStoriesSetting",kind:"LinkedField",name:"unified_stories_setting",plural:!1,selections:[c,{alias:null,args:d,concreteType:"UnifiedStoriesBlockedParticipantsConnection",kind:"LinkedField",name:"blocked_participants",plural:!1,selections:j,storageKey:"blocked_participants(first:5000)"},{alias:null,args:d,concreteType:"UnifiedStoriesCustomParticipantsConnection",kind:"LinkedField",name:"custom_participants",plural:!1,selections:j,storageKey:"custom_participants(first:5000)"}],storageKey:null},{alias:null,args:null,concreteType:"StoriesData",kind:"LinkedField",name:"stories_data",plural:!1,selections:[k],storageKey:null}],storageKey:null}],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FBStoriesPrivacyChangeSubscription",selections:[{alias:null,args:b,concreteType:"UnifiedStoriesPrivacyChangeSubscribeResponsePayload",kind:"LinkedField",name:"unified_stories_privacy_change_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UnifiedStoriesSetting",kind:"LinkedField",name:"unified_stories_setting",plural:!1,selections:[c,{alias:null,args:d,concreteType:"UnifiedStoriesBlockedParticipantsConnection",kind:"LinkedField",name:"blocked_participants",plural:!1,selections:e,storageKey:"blocked_participants(first:5000)"},{alias:null,args:d,concreteType:"UnifiedStoriesCustomParticipantsConnection",kind:"LinkedField",name:"custom_participants",plural:!1,selections:e,storageKey:"custom_participants(first:5000)"},f],storageKey:null},{alias:null,args:null,concreteType:"StoriesData",kind:"LinkedField",name:"stories_data",plural:!1,selections:[k,f],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"2727307000625372",metadata:{subscriptionName:"unified_stories_privacy_change_subscribe"},name:"FBStoriesPrivacyChangeSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("FBStoriesTraySubscription.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"StoriesTraySubscribeResponsePayload",kind:"LinkedField",name:"stories_tray_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"story_actor_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FBStoriesTraySubscription",selections:b,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FBStoriesTraySubscription",selections:b},params:{id:"2743930572305503",metadata:{subscriptionName:"stories_tray_subscribe"},name:"FBStoriesTraySubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("CameraPostDirectMarkSeenMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1644150182303893"};b.getQueryID=function(){return"171816796723339"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("CameraPostLoggingEvents",[],(function(a,b,c,d,e,f){"use strict";a="send_direct_reply_attempted";f.SEND_REPLY_ATTEMPT=a;b="send_direct_reply_success";f.SEND_REPLY_SUCCESS=b;c="send_direct_reply_failure";f.SEND_REPLY_FAILURE=c;d="view";f.THREAD_VIEWED=d;e="mark_thread_seen_attempted";f.THREAD_MARK_SEEN_ATTEMPT=e;a="mark_thread_seen_success";f.THREAD_MARK_SEEN_SUCCESS=a;b="mark_thread_seen_failure";f.THREAD_MARK_SEEN_FAILURE=b;c="clickout";f.DIRECT_VIEWER_CLICKOUT=c}),null);
__d("CameraPostQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"2217242731640138"};b.getQueryID=function(){return"2218304265112137"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("CameraPostRepliesQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1494166853955273"};b.getQueryID=function(){return"1468697053209427"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("CameraPostReplyMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1459763854077111"};b.getQueryID=function(){return"1849675045338105"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("CameraPostUserQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1652248708148952"};b.getQueryID=function(){return"143159039576179"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("CameraPostGraphQLAPI",["Banzai","CameraPostDirectMarkSeenMutationWebGraphQLMutation","CameraPostLoggingEvents","CameraPostQueryWebGraphQLQuery","CameraPostRepliesQueryWebGraphQLQuery","CameraPostReplyMutationWebGraphQLMutation","CameraPostUserQueryWebGraphQLQuery","DirectMessagingTypedLogger","FBStoriesLoggingConstants","WebGraphQL","uuid"],(function(a,b,c,d,e,f){"use strict";var g=function(a,c,d,e,f,g,h){if(e!=null){var i=new(b("DirectMessagingTypedLogger"))().setCameraPostType(c).setProductSurface("www").setName(e).setCardID(a.toString());if(d.message){var j=d.message.length;i.setMessageLength(j)}h&&i.setReplyType(h);d.sticker_id&&i.addToExtraData("sticker_id",d.sticker_id);d.gif_url&&i.addToExtraData("gif_url",d.gif_url);i.log();b("Banzai").post("stories_interaction_poseidon_logging_banzai",{name:e,thread_id:String(a)})}var k={};k.is_fb_story=!0;k.thread_id=a;k.camera_post_type=c;k.attempt_name=e;k.event=b("FBStoriesLoggingConstants").ACTION_SEND_REPLY_ATTEMPT;return b("WebGraphQL").exec(new(b("CameraPostReplyMutationWebGraphQLMutation"))({input:d})).then(function(d){if(f!=null){var e=new(b("DirectMessagingTypedLogger"))().setCameraPostType(c).setProductSurface("www").setName(f).setCardID(a.toString());h&&e.setReplyType(h);e.log()}k.success_name=f;b("Banzai").post("fb_stories_banzai_generic",{ft:k});return d},function(d){if(g!=null){var e=new(b("DirectMessagingTypedLogger"))().setCameraPostType(c).setProductSurface("www").setName(g).setCardID(a.toString());h&&e.setReplyType(h);e.log()}k.failure_name=g;b("Banzai").post("fb_stories_banzai_generic",{ft:k});return d})};a=function(a,c,d,e,f){var h=b("uuid")();h={client_mutation_id:h,actor_id:a,thread_id:c,message:d};a=null;d=null;var i=null;f?a=b("FBStoriesLoggingConstants").ACTION_SEND_REPLY_ATTEMPT:(a=b("CameraPostLoggingEvents").SEND_REPLY_ATTEMPT,d=b("CameraPostLoggingEvents").SEND_REPLY_SUCCESS,i=b("CameraPostLoggingEvents").SEND_REPLY_FAILURE);return g(c,e,h,a,d,i)};f.sendDirectMessageReply=a;c=function(a,c,d,e){var f=b("uuid")();f={client_mutation_id:f,actor_id:a,thread_id:c,sticker_id:e};return g(c,d,f,null,null,null)};f.sendDirectStickerReply=c;d=function(a,c,d,e){var f=b("uuid")();f={client_mutation_id:f,actor_id:a,thread_id:c,gif_url:e};return g(c,d,f,null,null,null)};f.sendDirectGifReply=d;e=function(a,c,d,e,f){var h="LIGHT_WEIGHT";a={client_mutation_id:b("uuid")(),actor_id:a,thread_id:c,message:e,story_reply_type:h,is_lightweight_reaction:!0,lightweight_reaction_actions:{reaction:e,offsets:[f||0]}};return g(c,d,a,null,null,null,"light_weight")};f.sendLightweightReactionReply=e;a=function(a,c){return b("WebGraphQL").exec(new(b("CameraPostQueryWebGraphQLQuery"))({thread_id:c})).then(function(a){var d;d=(d=a)!=null?(d=d.node)!=null?d.camera_post_type:d:d;new(b("DirectMessagingTypedLogger"))().setCameraPostType(d).setName(b("CameraPostLoggingEvents").THREAD_VIEWED).setProductSurface("www").setCardID(c.toString()).log();return a},function(a){return a})};f.loadThreadFullInformation=a;c=function(){return b("WebGraphQL").exec(new(b("CameraPostUserQueryWebGraphQLQuery"))())};f.loadUserInfo=c;d=function(a){return b("WebGraphQL").exec(new(b("CameraPostRepliesQueryWebGraphQLQuery"))({thread_id:a}))};f.loadRepliesForThread=d;e=function(a,c,d,e,f){var g={};f?g={client_mutation_id:b("uuid")(),actor_id:a,story_id:f,last_message_seen_id:d}:g={client_mutation_id:b("uuid")(),actor_id:a,thread_id:c,last_message_seen_id:d};f=new(b("DirectMessagingTypedLogger"))().setCameraPostType(e).setName(b("CameraPostLoggingEvents").THREAD_MARK_SEEN_ATTEMPT).setProductSurface("www").setCardID(c.toString());f.log();var h={};h.is_fb_story=!0;h.camera_post_type=e;h.event=b("CameraPostLoggingEvents").THREAD_MARK_SEEN_ATTEMPT;h.thread_id=c;h.latest_message_id=d;return b("WebGraphQL").exec(new(b("CameraPostDirectMarkSeenMutationWebGraphQLMutation"))({input:g})).then(function(a){new(b("DirectMessagingTypedLogger"))().setCameraPostType(e).setProductSurface("www").setName(b("CameraPostLoggingEvents").THREAD_MARK_SEEN_SUCCESS).setCardID(c.toString()).log();h.sucess_name=b("CameraPostLoggingEvents").THREAD_MARK_SEEN_SUCCESS;b("Banzai").post("fb_stories_banzai_generic",{ft:h});return a},function(a){new(b("DirectMessagingTypedLogger"))().setCameraPostType(e).setProductSurface("www").setName(b("CameraPostLoggingEvents").THREAD_MARK_SEEN_FAILURE).setCardID(c.toString()).log();h.failur_name=b("CameraPostLoggingEvents").THREAD_MARK_SEEN_FAILURE;b("Banzai").post("fb_stories_banzai_generic",{ft:h});return a})};f.markThreadSeen=e;a=function(){return new(b("DirectMessagingTypedLogger"))()};f._getLogger=a}),null);
__d("CameraPostBucketOwnerHelper",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";f.getId=a;f.getName=c;f.getGender=d;f.isEventHost=e;f.isEventHostPageAdmin=g;f.isViewerFriend=h;f.isEmployee=i;f.getProfilePictureUri=j;f.getCoverPhotoUri=k;f.isViewerPageContentAdmin=l;f.isViewerGroupModerator=m;f.isViewerGroupAdmin=n;f.isViewerGroupMember=o;f._getViewerProfilePermissions=p;f._getViewerAdminType=q;f.requiresAdminApproval=r;f.isGroupAdmin=s;f.isGroupMember=t;f.isBuySellGroup=u;f.isMutedFromGroup=v;f.setIsMutedFromGroup=w;f._getIdsFromEdges=x;function a(a){return((a=a)!=null?a.id:a)||""}function c(a){return((a=a)!=null?a.name:a)||""}function d(a){return!a?"":a.gender?a.gender:""}function e(a){if(!a)return!1;var b=a.event_hosts&&a.event_hosts.edges.some(function(a){return g(a.node)});return!!(a.is_viewer_host||b)}function g(a){a=a.page_admin_users;if(!a)return!1;var c=b("CurrentUser").getID();return a.edges.some(function(a){return a.node.id===c})}function h(a){return!a?!1:a.is_viewer_friend?!!a.is_viewer_friend:!1}function i(a){return!a?!1:a.is_employee?!!a.is_employee:!1}function j(a){return!a||!a.profile_picture?"":a.profile_picture.uri||""}function k(a){return!a||!a.cover_photo?"":((a=a)!=null?(a=a.cover_photo)!=null?(a=a.photo)!=null?(a=a.image)!=null?a.uri:a:a:a:a)||""}function l(a){a=p(a);return a&&a.includes("EDIT_PROFILE")||!1}function m(a){a=q(a);return a==="MODERATOR"}function n(a){a=q(a);return a==="ADMIN"}function o(a){return!a||!a.is_viewer_member?!1:a.is_viewer_member}function p(a){return!a||!a.viewer_profile_permissions?null:((a=a)!=null?a.viewer_profile_permissions:a)||null}function q(a){return!a||!a.viewer_admin_type?null:((a=a)!=null?a.viewer_admin_type:a)||null}function r(a){return!a?!1:a.story_approval_required&&!!a.story_approval_required||(a.stories_admin_approval_required_setting?a.stories_admin_approval_required_setting==="ON":!1)}function s(a,b){if(!a||!a.group_admin_profiles)return!1;a=((a=a)!=null?(a=a.group_admin_profiles)!=null?a.edges:a:a)||[];a=x(a);a=new Set(a);return a.has(b)}function t(a,b){b=(b=b.groups)==null?void 0:b.edges;if(b==null)return!1;b=new Set(b.map(function(a){return(a=a.node)==null?void 0:a.id}));return b.has(a.id)}function u(a){if(!a||!a.group_purposes)return!1;a=a.group_purposes.edges.map(function(a){return a.node.purpose_enum});return a.includes("for_sale".toUpperCase())}function v(a,b){if(!a||!a.group_muted_members)return!1;a=a.group_muted_members.edges;return x(a).includes(b)}function w(a,b,c){if(!a||!a.group_muted_members)return;var d=a.group_muted_members.edges,e=v(a,b);c!==e&&(c?d.push({node:{id:b}}):a.group_muted_members={edges:d.filter(function(a){a.node.id!==b})})}function x(a){return a.map(function(a){return a.node.id})}}),null);
__d("CameraPostMediaHelper",[],(function(a,b,c,d,e,f){"use strict";f.getId=a;f.getWidth=b;f.getHeight=c;f.getType=g;f.getImageUri=d;f.getBlurImageUri=e;f.isSphericalPhoto=h;f.isImage=i;f.isVideo=j;f.getPreviewImage=k;f.makeOptimisticPhotoMedia=l;f.hasObjectionableContent=m;function a(a){return((a=a)!=null?a.id:a)||""}function b(a){if(!a)return 0;if(a.width)return a.width;return a.image?a.image.width||0:0}function c(a){if(!a)return 0;if(a.height)return a.height;return a.image?a.image.height||0:0}function g(a){return((a=a)!=null?a.__typename:a)||""}function d(a){return!a?null:a.image?a.image.uri:null}function e(a){return!a?null:a.image_blurred?a.image_blurred.uri:null}function h(a){return!a?!1:a.photo_encodings?a.photo_encodings.length>0:!1}function i(a){return g(a)==="Photo"}function j(a){return g(a)==="Video"}function k(a){return!a?null:a.preview_image?a.preview_image.uri:null}function l(a){return{id:null,message:null,__typename:"Photo",preview_image:{uri:a,width:null,height:null},image:{uri:a,width:null,height:null},image_blurred:{uri:a,width:null,height:null}}}function m(a){if(!a||!i(a)&&!j(a))return!1;a=a.objectionable_content_info?a.objectionable_content_info:null;if(a){a=a.categories;return a&&a.length>0}return!1}}),null);
__d("CameraPostThreadOwnerHelper",[],(function(a,b,c,d,e,f){"use strict";f.getId=a;f.getName=b;f.getIsViewerFriend=c;f.getProfilePictureUri=d;function a(a){return(a=a)!=null?a.id:a}function b(a){return((a=a)!=null?a.name:a)||""}function c(a){return!!((a=a)!=null?a.is_viewer_friend:a)}function d(a){return((a=a)!=null?(a=a.profile_picture)!=null?a.uri:a:a)||""}}),null);
__d("CameraPostTypesHelper",[],(function(a,b,c,d,e,f){"use strict";f.isEventStory=g;f.isGroupStory=h;f.isBirthdayStory=i;f.isMultiAuthor=a;f.isPageStory=b;f.isPromotionStory=c;f.isStory=d;f.isStoryNux=e;function g(a){return a==="EVENT_STORY"}function h(a){return a==="GROUP_STORY"}function i(a){return a==="BIRTHDAY_STORY"}function a(a){return g(a)||h(a)||i(a)}function b(a){return a==="PAGE_STORY"}function c(a){return a==="PROMOTION_STORY"}function d(a){return a==="STORY"}function e(a){return a==="STORY_NUX"}}),null);
__d("FBStoriesArchivedCardQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"2473649175992196"};b.getQueryID=function(){return"243055063287658"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesAudienceModeMutationCallMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1883080631763254"};b.getQueryID=function(){return"196508534442477"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesBucketsMigrationQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"3373746366016192"};b.getQueryID=function(){return"2821486628136059"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesBucketsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"3287198498036805"};b.getQueryID=function(){return"2777092015900845"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesDeleteMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1340045906066120"};b.getQueryID=function(){return"967072946766012"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesGating",["gkx","qex"],(function(a,b,c,d,e,f){"use strict";f.shouldUseTrayMigration=a;f.getMaxBucketsForTrayLoad=c;f.isFriendsAndConnectionsOptionDeprecated=d;function a(){return b("qex")._("835044")||!1}function c(){var a;return(a=b("qex")._("863217"))!=null?a:100}function d(){return b("gkx")("1234255")}}),null);
__d("FBStoriesMuteMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1524574307634402"};b.getQueryID=function(){return"1944151819168048"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesMutedBucketOwnersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1891920954170361"};b.getQueryID=function(){return"294951511028390"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesPageBucketQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"3516743045044144"};b.getQueryID=function(){return"241701400418022"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("BaseGraphQLSubscription",["regeneratorRuntime","BanzaiODS","CurrentLocale","CurrentUser","Random","RelayRTIGraphQLSubscriber","RelayRTIUtils","SkywalkerManager","gkx","nullthrows","relay-runtime","uuid"],(function(a,b,c,d,e,f){var g=b("RelayRTIGraphQLSubscriber").subscribeWithMobileStyleTopicTransform,h=b("RelayRTIUtils").computeRoutingHint,i=b("RelayRTIUtils").extractUseCaseFromTopic,j=b("RelayRTIUtils").logSubscriptionEvent,k=b("relay-runtime").getRequest,l=100,m=1e3,n=100,o="gqls_default_logging_base",p="gqls_workplace_logging_base",q=110,r={bumpTotalSubscribeCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".subscribe.total")},bumpLegacySubscribeCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".subscribe.legacy"),r.bumpTotalSubscribeCounter(a)},bumpSsttSubscribeCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".subscribe.sstt"),r.bumpTotalSubscribeCounter(a)},bumpTotalReceiveCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".receive.total")},bumpLegacyReceiveCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".receive.legacy"),r.bumpTotalReceiveCounter(a)},bumpSsttReceiveCounter:function(a){b("BanzaiODS").bumpEntityKey(q,"basegraphqlsubscription_migration",a+".receive.sstt"),r.bumpTotalReceiveCounter(a)}};function s(a){if(b("gkx")("676906")&&b("Random").coinflip(l))return o;if(b("gkx")("1383502")&&b("Random").coinflip(n))return p;if(b("gkx")("1388683")||b("gkx")("1382775")&&b("Random").coinflip(m))return o}a=function(){"use strict";function a(){}var c=a.prototype;c.getTopic=function(a){throw new Error("getTopic() unimplemented by subclass of BaseGraphQLSubscription")};c.getQuery=function(){throw new Error("getQuery() or getQueryID() unimplemented by subclass of BaseGraphQLSubscription")};c.getQueryParameters=function(a){throw new Error("getQueryParameters() unimplemented by subclass of BaseGraphQLSubscription")};c.getSubscriptionName=function(){var a=k(this.getQuery());return String(b("nullthrows")(a.params.metadata.subscriptionName))};a.subscribe=function(a,b,c){return new this().subscribe(a,b,c)};c.subscribe=function(a,c,d){var e,f=this.getQueryParameters(a),h=k(this.getQuery()).params,i=String(b("nullthrows")((e=h.metadata)==null?void 0:e.subscriptionName));if(t(i)){e="gqls/"+i+"/";var l=b("SkywalkerManager").getSubscriptionType(e);f=babelHelpers["extends"]({},f,{input:babelHelpers["extends"]({},f.input,{client_subscription_id:b("uuid")()})});r.bumpSsttSubscribeCounter(i);e=g(h,f,d==null?void 0:d.forceLogContext,d==null?void 0:d.viewerID)["do"]({start:function(){j("client_subscribe",i,f,d==null?void 0:d.forceLogContext,l,h.id)},next:function(){j("receivepayload",i,f,d==null?void 0:d.forceLogContext,l,h.id)},unsubscribe:function(){j("client_unsubscribe",i,f,d==null?void 0:d.forceLogContext,l,h.id)}});return e.subscribe({next:function(a){r.bumpSsttReceiveCounter(i),typeof a=="object"&&a.data&&c(a.data)}})}e=this.getTopic(a);var m=v(e,b("nullthrows")(k(this.getQuery()).params.id),f,c,d);return{unsubscribe:function(){m.unsubscribe()}}};return a}();a.getTransformContextForBaseGraphQLSubscription_INTERNAL=u;a.subscribeWithSkywalker_INTERNAL=v;function t(a){return a==="web_notification_receive_subscribe"?b("gkx")("1767570"):!1}function u(a,c,d){var e="0";return{viewerID:(d=d)!=null?d:b("CurrentUser").getID(),appID:e,locale:b("CurrentLocale").get(),queryID:a,serializedQueryParameters:JSON.stringify(c),useOSSResponseFormat:!1}}function v(a,c,d,e,f){f===void 0&&(f=null);var g=b("nullthrows")(i(a)),k=b("SkywalkerManager").getSubscriptionType(a);r.bumpLegacySubscribeCounter(g);var l=b("uuid")(),m=babelHelpers["extends"]({},d,{input:babelHelpers["extends"]({},d.input,{client_subscription_id:l})}),n=(d=(d=f)==null?void 0:d.forceLogContext)!=null?d:s(a);n!=null&&(m=babelHelpers["extends"]({},m,{"%options":{client_logged_context:n}}));m=babelHelpers["extends"]({},m,{"%options":babelHelpers["extends"]({},m["%options"],{client_has_ods_usecase_counters:!0})});d={};d.transformContext=JSON.stringify(u(c,m,(f=f)==null?void 0:f.viewerID));f=null;if(l!=null){var o;f=babelHelpers["extends"]({},(o=f)!=null?o:{},{requestId:l})}o=h(g,m.input);if(o!=null){var p;f=babelHelpers["extends"]({},(p=f)!=null?p:{},{routing_hint:o})}j("client_subscribe",g,m,n,k,c);p=babelHelpers["extends"]({context:d,onUnsubscribeEager:function(){j("client_unsubscribe",g,m,n,k,c)},gqlsLifecycleHandler:function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:e({__type:"lifecycle_event",state:a});case 1:case"end":return b.stop()}},null,this)}},f?{headers:f}:{});o=null;n!=null&&(o={requestId:l,forceLogContext:n});o!=null&&(p=babelHelpers["extends"]({},p,{instrumentationData:o}));return b("SkywalkerManager").subscribe(a,function(a){j("receivepayload",g,m,n,k,c),r.bumpLegacyReceiveCounter(g),e(babelHelpers["extends"]({__type:"data"},JSON.parse(a.payload)))},p)}e.exports=a}),null);
__d("FBStoriesPrivacyChangeSubscription",["BaseGraphQLSubscription","relay-runtime","FBStoriesPrivacyChangeSubscription.graphql"],(function(a,b,c,d,e,f){var g;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getTopic=function(a){return"gqls/"+this.getSubscriptionName()+"/owner_id_"+a};d.getQuery=function(){return g!==void 0?g:g=b("FBStoriesPrivacyChangeSubscription.graphql")};d.getQueryParameters=function(a){return{input:{owner_id:a}}};return c}(b("BaseGraphQLSubscription"));e.exports=a}),null);
__d("FBStoriesPrivacySettingsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1636640369763506"};b.getQueryID=function(){return"153291488685319"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1386522808128715"};b.getQueryID=function(){return"1384057201673076"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesTakeNegativeFeedbackActionMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1997102860360908"};b.getQueryID=function(){return"345862519273111"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesTraySubscription",["BaseGraphQLSubscription","relay-runtime","FBStoriesTraySubscription.graphql"],(function(a,b,c,d,e,f){var g;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getTopic=function(a){return"gqls/"+this.getSubscriptionName()+"/user_id_"+a};d.getQuery=function(){return g!==void 0?g:g=b("FBStoriesTraySubscription.graphql")};d.getQueryParameters=function(a){return{input:{user_id:a}}};return c}(b("BaseGraphQLSubscription"));e.exports=a}),null);
__d("FBStoriesUnifiedSeenReceiptLastSeenTimeMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1530421027083413"};b.getQueryID=function(){return"213614895981437"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("FBStoriesViewerBucketQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"3086342188101329"};b.getQueryID=function(){return"3003130936463273"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesViewerBucketViewersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"2224434790905865"};b.getQueryID=function(){return"2219192941644387"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesVotePollMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1942364135805651"};b.getQueryID=function(){return"1772533953042568"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("GroupUnmuteMemberMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1224583300980768"};b.getQueryID=function(){return"454589191691586"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("ReactionStickerStoryCardReactMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1651380361616532"};b.getQueryID=function(){return"603085890111081"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("ReportStoryCardToAdminWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1435403036581993"};b.getQueryID=function(){return"909342722558820"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("StoriesArchiveCardViewerQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"2649821275029172"};b.getQueryID=function(){return"218194525798087"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("StoriesArchiveDeletionMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"997271687064551"};b.getQueryID=function(){return"2146552195626815"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("UnifiedStoriesArchiveSavingModeMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"2879905198698528"};b.getQueryID=function(){return"240974536483368"};return b}(b("WebGraphQLMutationBase"))}),null);
__d("UnifiedStoriesSettingGraphQLWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";e.exports=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.__getDocID=function(){return"1619282521526216"};b.getQueryID=function(){return"2045499392436729"};return b}(b("WebGraphQLQueryBase"))}),null);
__d("FBStoriesGraphQLAPI",["CurrentUser","FBStoriesArchivedCardQueryWebGraphQLQuery","FBStoriesAudienceModeMutationCallMutationWebGraphQLMutation","FBStoriesBucketsMigrationQueryWebGraphQLQuery","FBStoriesBucketsQueryWebGraphQLQuery","FBStoriesDeleteMutationWebGraphQLMutation","FBStoriesGating","FBStoriesMutedBucketOwnersQueryWebGraphQLQuery","FBStoriesMuteMutationWebGraphQLMutation","FBStoriesPageBucketQueryWebGraphQLQuery","FBStoriesPrivacyChangeSubscription","FBStoriesPrivacySettingsQueryWebGraphQLQuery","FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation","FBStoriesTakeNegativeFeedbackActionMutationWebGraphQLMutation","FBStoriesTraySubscription","FBStoriesUnifiedSeenReceiptLastSeenTimeMutationWebGraphQLMutation","FBStoriesViewerBucketQueryWebGraphQLQuery","FBStoriesViewerBucketViewersQueryWebGraphQLQuery","FBStoriesVotePollMutationWebGraphQLMutation","GroupUnmuteMemberMutationWebGraphQLMutation","ReactionStickerStoryCardReactMutationWebGraphQLMutation","ReportStoryCardToAdminWebGraphQLMutation","StoriesArchiveCardViewerQueryWebGraphQLQuery","StoriesArchiveDeletionMutationWebGraphQLMutation","UnifiedStoriesArchiveSavingModeMutationWebGraphQLMutation","UnifiedStoriesSettingGraphQLWebGraphQLQuery","WebGraphQL","uniqueID"],(function(a,b,c,d,e,f){"use strict";e.exports={load:function(){var a=b("FBStoriesGating").getMaxBucketsForTrayLoad();return b("WebGraphQL").exec(b("FBStoriesGating").shouldUseTrayMigration()?new(b("FBStoriesBucketsMigrationQueryWebGraphQLQuery"))({maxBuckets:a}):new(b("FBStoriesBucketsQueryWebGraphQLQuery"))({maxBuckets:a}))},loadSingleBucketStoryData:function(a){return b("WebGraphQL").exec(new(b("FBStoriesViewerBucketQueryWebGraphQLQuery"))({bucketID:a,threadCount:100}))},loadPageBucketStoryData:function(a){return b("WebGraphQL").exec(new(b("FBStoriesPageBucketQueryWebGraphQLQuery"))({pageID:a}))},loadSingleArchivedCardData:function(a){return b("WebGraphQL").exec(new(b("FBStoriesArchivedCardQueryWebGraphQLQuery"))({storyID:a}))},loadPrivacySettings:function(){return b("WebGraphQL").exec(new(b("FBStoriesPrivacySettingsQueryWebGraphQLQuery"))({}))},loadViewerListForThread:function(a){return b("WebGraphQL").exec(new(b("FBStoriesViewerBucketViewersQueryWebGraphQLQuery"))({threadId:a}))},loadStoriesArchiveSavingMode:function(){return b("WebGraphQL").exec(new(b("UnifiedStoriesSettingGraphQLWebGraphQLQuery"))({}))},loadArchivedCardsData:function(a,c,d,e){return b("WebGraphQL").exec(new(b("StoriesArchiveCardViewerQueryWebGraphQLQuery"))({current_id:a,current_time:c,lower_bound_time:d,upper_bound_time:e}))},subscribeToPrivacyChanges:function(a){return b("FBStoriesPrivacyChangeSubscription").subscribe(b("CurrentUser").getID(),a)},subscribeToTrayChanges:function(a){return b("FBStoriesTraySubscription").subscribe(b("CurrentUser").getID(),a)},unsubscribeFromTrayChanges:function(a){a.unsubscribe()},updateThreadSeenReciept:function(a){a={client_mutation_id:b("uniqueID")(),actor_id:b("CurrentUser").getID(),thread_id:a};return b("WebGraphQL").exec(new(b("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation"))({input:a}))},updateStorySeenReciept:function(a){a={client_mutation_id:b("uniqueID")(),actor_id:b("CurrentUser").getID(),story_id:a};return b("WebGraphQL").exec(new(b("FBStoriesUnifiedSeenReceiptLastSeenTimeMutationWebGraphQLMutation"))({input:a}))},deleteStory:function(a,c){return b("WebGraphQL").exec(new(b("FBStoriesDeleteMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,story_thread_ids:[c]}}))},muteBucketOwner:function(a,c,d){return b("WebGraphQL").exec(new(b("FBStoriesMuteMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,user_id:c,should_unfollow_user_story:d}}))},loadMutedBucketOwnersList:function(){return b("WebGraphQL").exec(new(b("FBStoriesMutedBucketOwnersQueryWebGraphQLQuery"))({}))},pollVote:function(a,c){return b("WebGraphQL").exec(new(b("FBStoriesVotePollMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),story_card_poll_id:a,option:c,actor_id:b("CurrentUser").getID()}}))},reactToSticker:function(a,c){return b("WebGraphQL").exec(new(b("ReactionStickerStoryCardReactMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:b("CurrentUser").getID(),story_card_reaction_sticker_id:a,count:c}}))},reportThreadToAdmin:function(a,c){return b("WebGraphQL").exec(new(b("ReportStoryCardToAdminWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,report_to_admin_action:"REPORT",story_card_id:c}}))},takeNegativeFeedbackAction:function(a,c,d){return b("WebGraphQL").exec(new(b("FBStoriesTakeNegativeFeedbackActionMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,negative_feedback_action_id:d}}))},changeAudienceMode:function(a,c){return b("WebGraphQL").exec(new(b("FBStoriesAudienceModeMutationCallMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,audience_mode:c}}))},updateArchiveSavingMode:function(a,c){return b("WebGraphQL").exec(new(b("UnifiedStoriesArchiveSavingModeMutationWebGraphQLMutation"))({saving_mode:{client_mutation_id:b("uniqueID")(),actor_id:a,saving_mode:c}}))},deleteArchivedStoryCard:function(a,c){return b("WebGraphQL").exec(new(b("StoriesArchiveDeletionMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,archived_story_card_id:c}}))},unmuteFromGroup:function(a,c,d){return b("WebGraphQL").exec(new(b("GroupUnmuteMemberMutationWebGraphQLMutation"))({input:{client_mutation_id:b("uniqueID")(),actor_id:a,group_id:c,user_id:d}}))}}}),null);
__d("FBStoriesActionTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({LOAD:"FB_STORIES.LOAD",LOADING:"FB_STORIES.LOADING",LOADED:"FB_STORIES.LOADED",LOADED_ERROR:"FB_STORIES.LOADED_ERROR",VIEWER_LIST_LOADED_FOR_THREAD:"FB_STORIES.VIEWER_LIST_LOADED_FOR_THREAD",RESET_LOCAL_SEEN_HISTORY:"FB_STORIES.RESET_LOCAL_SEEN_HISTORY",SELECTED_BUCKET_IDX_CHANGED:"FB_STORIES.SELECTED_BUCKET_IDX_CHANGED",SET_ALL_BUCKETS_VIEWED:"FB_STORIES.SET_ALL_BUCKETS_VIEWED",SET_UNSEEN_MODE:"FB_STORIES.SET_UNSEEN_MODE",SELECTED_THREAD_IDX_CHANGED:"FB_STORIES.SELECTED_THREAD_IDX_CHANGED",SELECTED_THREAD_PERCENT_DONE:"FB_STORIES.SELECTED_THREAD_PERCENT_DONE",SUBSCRIPTION_BUCKET_UPDATE:"FB_STORIES.SUBSCRIPTION_BUCKET_UPDATE",UPDATE_THREAD_SEEN_OPTIMISTIC:"FB_STORIES.UPDATE_THREAD_SEEN_OPTIMISTIC",UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:"FB_STORIES.UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC",DELETE_THREAD_FROM_BUCKET:"FB_STORIES.DELETE_THREAD_FROM_BUCKET",REMOVE_BUCKET:"FB_STORIES.REMOVE_BUCKET",REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:"FB_STORIES.REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET",SET_IS_COMMERCIAL_BREAK_RUNNING:"FB_STORIES.SET_IS_COMMERCIAL_BREAK_RUNNING",UNSELECT_BUCKET:"FBSTORIES.UNSELECT_BUCKET",SET_VIEWER_OPEN:"FB_STORIES.SET_VIEWER_OPEN",OPTIMISTIC_CREATE_PHOTO_STORY:"FB_STORIES.OPTIMISTIC_CREATE_PHOTO_STORY",SET_USER_BUCKET_UPLOAD_STATUS:"FB_STORIES.SET_USER_BUCKET_UPLOAD_STATUS",RESET_STATE:"FB_STORIES.RESET_STATE",SET_SUBSCRIPTION_TOKEN:"FB_STORIES.SET_SUBSCRIPTION_TOKEN",OPTIMISTIC_POLL_VOTE:"FB_STORIES.OPTIMISTIC_POLL_VOTE",TAP_ON_REACTION_STICKER:"FB_STORIES.TAP_ON_REACTION_STICKER",SET_IS_PRODUCTION_DIALOG_LOADING:"FB_STORIES.SET_IS_PRODUCTION_DIALOG_LOADING",APPROVE_PENDING_THREAD:"FB_STORIES.APPROVE_PENDING_THREAD"});e.exports=a}),null);
__d("FBStoriesDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}return b}(b("ExplicitRegistrationReactDispatcher"));c=new a({strict:!0});e.exports=c}),null);
__d("FBStoriesActions",["CameraPostBucketOwnerHelper","CameraPostGraphQLAPI","FBLogger","FBStoriesActionsHelper","FBStoriesActionTypes","FBStoriesDispatcher","FBStoriesGraphQLAPI","FBStoriesLoggingConstants","FBStoriesLoggingHelper","FBStoriesMutedBucketOwnersActions","FBStoriesPrefetcher","FBStoriesStore","promiseDone"],(function(a,b,c,d,e,f){"use strict";f.muteBucketOwner=a;f.reportThreadToAdmin=c;f.takeNegativeFeedbackAction=d;f.removeEndedLiveVideo=p;f.setIsCommercialBreakRunning=e;f.unselectBucket=q;f.optimisticCreateStoryPhoto=r;f.setUserBucketUploadStatus=s;f.onPollOptionVoted=t;f.onReactToSticker=u;f.setIsProductionDialogLoading=v;f.approvePendingThread=w;var g=b("FBStoriesDispatcher").dispatch;a=function(){g({type:b("FBStoriesActionTypes").RESET_STATE})};f.resetStore=a;c=function(a,c,d,e,f){g({type:b("FBStoriesActionTypes").LOADED,data:{userInfo:{userName:a,userID:c,userGender:null,userProfilePic:{uri:d}},userBucketData:null,friendsBucketData:f}})};f.loadData=c;var h=function(a){var c=b("FBStoriesStore").isSelectedBucketLive();if(c){j();return}c=b("FBStoriesStore").getThreadsForSelectedBucket();var d=b("FBStoriesStore").getCurrentThreadIndexForSelectedBucket();a=a!==void 0?a:d+1;c.length===0?j():a<=c.length-1?m(a):j()};f.nextThread=h;var i=function(a){var c=b("FBStoriesStore").isSelectedBucketLive();if(c){k();return}c=b("FBStoriesStore").getThreadsForSelectedBucket();var d=b("FBStoriesStore").getCurrentThreadIndexForSelectedBucket();a=a!==void 0?a:d-1;c.length===0?k():a>=0?m(a,!0):k()};f.prevThread=i;var j=function(){return o(!0)};f.nextBucket=j;var k=function(){return o(!1)};f.prevBucket=k;d=function(a){var c=b("FBStoriesStore").getBucketIndexByBucketId(a);if(c===-1)return!1;var d=b("FBStoriesStore").getUnseenThreadIndex(c),e=Math.max(0,d);a=b("FBStoriesStore").isOwnBucket(a);g({type:b("FBStoriesActionTypes").RESET_LOCAL_SEEN_HISTORY});g({type:b("FBStoriesActionTypes").SET_UNSEEN_MODE,value:!a&&d>=0});g({type:b("FBStoriesActionTypes").SET_ALL_BUCKETS_VIEWED,value:!1});g({type:b("FBStoriesActionTypes").SELECTED_BUCKET_IDX_CHANGED,bucketIndex:c});m(e);return!0};f.userSelectedBucket=d;var l=function(a){g({type:b("FBStoriesActionTypes").SELECTED_THREAD_PERCENT_DONE,percentDone:a})};f.updateCurrentThreadPercentDone=l;var m=function(a,c){c===void 0&&(c=!1);var d=b("FBStoriesStore").isOwnBucket();g({type:b("FBStoriesActionTypes").SELECTED_THREAD_IDX_CHANGED,index:a});l(0);a=b("FBStoriesStore").getCurrentThreadData();if(a){if(d&&!a.isLive){var e=a.threadID;b("promiseDone")(b("FBStoriesGraphQLAPI").loadViewerListForThread(e),function(a){return g({type:b("FBStoriesActionTypes").VIEWER_LIST_LOADED_FOR_THREAD,threadID:e,data:a})},function(a){return b("FBLogger")("fbstories").catching(a).mustfix("Cannot load viewer list for thread: %s",e)})}n();b("FBStoriesPrefetcher").prefetchForCurrentThreadAndBucket()}else c?i():h()};f.currentThreadIndexChanged=m;var n=function(){var a=b("FBStoriesStore").getUserInfo().userID,c=b("FBStoriesStore").getCurrentThreadData();if(!c||c.isLive)return;var d=c.latestMessageID,e=c.cameraPostType;c=c.threadID;g({type:b("FBStoriesActionTypes").UPDATE_THREAD_SEEN_OPTIMISTIC,bucketID:null,threadID:c});b("CameraPostGraphQLAPI").markThreadSeen(a,c,d,e)};f.markCurrentThreadAsSeen=n;e=function(a){g({type:b("FBStoriesActionTypes").UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC,threadID:a}),b("FBStoriesGraphQLAPI").updateThreadSeenReciept(a)};f.markThreadViewersSeen=e;var o=function(a,c){c=c!==void 0?c:b("FBStoriesStore").getSelectedBucketIndex();c=b("FBStoriesActionsHelper").getNextBucketAndThreadIndex(c,a);var d=c.nextBucketIndex;c=c.nextThreadIndex;var e=b("FBStoriesActionsHelper").checkAllBucketsViewed(d);g({type:b("FBStoriesActionTypes").SET_ALL_BUCKETS_VIEWED,value:e});if(e)return void 0;p();g({type:b("FBStoriesActionTypes").SELECTED_BUCKET_IDX_CHANGED,bucketIndex:d});if(!b("FBStoriesStore").hasDataInSelectedBucket()&&!b("FBStoriesStore").isSelectedBucketLive())return a?j():k();m(c);b("FBStoriesLoggingHelper").storyLog(b("FBStoriesLoggingConstants").ACTION_OPEN_STORY);return void 0};f._transitionBucket=o;q=function(a,c){if(!b("FBStoriesStore").isUserManagedThread(a,c))return;b("FBStoriesGraphQLAPI").deleteStory(b("FBStoriesStore").getUserInfo().userID,a);g({type:b("FBStoriesActionTypes").DELETE_THREAD_FROM_BUCKET,threadID:a,bucketID:c});h(b("FBStoriesStore").getCurrentThreadIndexForSelectedBucket())};f.deleteThreadFromBucket=q;function a(a,c){b("FBStoriesMutedBucketOwnersActions").setBucketOwnerMuted(b("CameraPostBucketOwnerHelper").getId(a),b("CameraPostBucketOwnerHelper").getName(a),b("CameraPostBucketOwnerHelper").getProfilePictureUri(a),!0);if(!c)return;g({type:b("FBStoriesActionTypes").REMOVE_BUCKET,bucketID:c});o(!0,b("FBStoriesStore").getSelectedBucketIndex()-1)}function c(a){b("FBStoriesGraphQLAPI").reportThreadToAdmin(b("FBStoriesStore").getUserInfo().userID,a)}function d(a,c){b("FBStoriesGraphQLAPI").takeNegativeFeedbackAction(b("FBStoriesStore").getUserInfo().userID,a,c)}function p(){if(!b("FBStoriesStore").isSelectedBucketLiveAndEnded())return;var a=b("FBStoriesStore").getSelectedBucketId();b("FBStoriesStore").getThreadsForSelectedBucket().length>0?g({type:b("FBStoriesActionTypes").REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET,bucketID:a}):g({type:b("FBStoriesActionTypes").REMOVE_BUCKET,bucketID:a})}function e(a,c){g({type:b("FBStoriesActionTypes").SET_IS_COMMERCIAL_BREAK_RUNNING,isCommercialBreakRunning:c,videoID:a})}function q(){g({type:b("FBStoriesActionTypes").UNSELECT_BUCKET})}function r(a){if(!a)return;g({type:b("FBStoriesActionTypes").OPTIMISTIC_CREATE_PHOTO_STORY,imageURL:a})}function s(a){g({type:b("FBStoriesActionTypes").SET_USER_BUCKET_UPLOAD_STATUS,isUploading:a})}function t(a,c){g({type:b("FBStoriesActionTypes").OPTIMISTIC_POLL_VOTE,index:c}),b("FBStoriesGraphQLAPI").pollVote(a,c)}function u(a,c){g({type:b("FBStoriesActionTypes").TAP_ON_REACTION_STICKER,stickerID:a,count:c}),b("FBStoriesGraphQLAPI").reactToSticker(a,c)}function v(a){g({type:b("FBStoriesActionTypes").SET_IS_PRODUCTION_DIALOG_LOADING,value:a})}function w(a,c){g({type:b("FBStoriesActionTypes").APPROVE_PENDING_THREAD,bucketID:a,threadID:c})}}),null);
__d("FBStoriesReactionStickerConstants",[],(function(a,b,c,d,e,f){"use strict";a={WIDTH:150,HEIGHT:150};f.DIMENSIONS=a;b=1e3;f.HOLD_DELAY=b;c=300;f.ANIMATIONS_INTERVAL_THROTTLE=c;d="StoryOverlayReactionSticker";f.StoryOverlayReactionSticker=d}),null);
__d("FBStoriesStoryCardHelper",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";a={getId:function(a){return((a=a)!=null?a.id:a)||""},getActor:function(a){a=(a=a)!=null?a.actors:a;return a?a[0]:null},getMedia:function(a){a=(a=a)!=null?a.attachments:a;return a?a[0].media:null},getActivityDescription:function(a){return(a=a)!=null?a.activity_description:a},getBackdropImage:function(a){a=(a=a)!=null?(a=a.backdrop)!=null?(a=a.media)!=null?(a=a.image)!=null?a.uri:a:a:a:a;return{image:{uri:a}}},getCameraPostSource:function(a){return((a=a)!=null?(a=a.story_card_info)!=null?(a=a.logging)!=null?a.source:a:a:a)||"CAMERA_SYSTEM"},getCameraPostType:function(a){return((a=a)!=null?(a=a.story_card_info)!=null?a.story_card_type:a:a)||"STORY"},getDefaultBackground:function(a){return((a=a)!=null?a.story_default_background:a)||null},getExplicitPlace:function(a){return((a=a)!=null?a.explicit_place:a)||null},getInlineActivities:function(a){return((a=a)!=null?a.inline_activities:a)||null},getIsPlainText:function(a){return((a=a)!=null?(a=a.story_card_info)!=null?a.is_plain_text:a:a)||!1},isSeenByViewer:function(a){return!!((a=a)!=null?(a=a.story_card_seen_state)!=null?a.is_seen_by_viewer:a:a)},getMediaBackground:function(a){a=(a=a)!=null?(a=a.story_card_info)!=null?(a=a.background_color_info)!=null?a.color_info:a:a:a;return a?a[0]:null},getMessageText:function(a){return((a=a)!=null?(a=a.message)!=null?a.text:a:a)||""},getMessageRanges:function(a){return((a=a)!=null?(a=a.message)!=null?a.messageRanges:a:a)||null},getTextFormatMetadata:function(a){return((a=a)!=null?a.text_format_metadata:a)||null},getTime:function(a){a=((a=a)!=null?(a=a.story_card_info)!=null?a.local_creation_time:a:a)||"";return Date.parse(a)/1e3},getOriginalPostStoryAttribution:function(a){return((a=a)!=null?(a=a.story_card_info)!=null?a.shareable_attribution:a:a)||null},getWithTags:function(a){return((a=a)!=null?a.with_tags:a)||null},getNegativeFeedbackActions:function(a){var b=this;if(!a)return null;a=(a=a)!=null?(a=a.negative_feedback_actions)!=null?a.edges:a:a;return a?a.map(function(a){return a.node}).filter(function(a){return a&&b._shouldRenderNFXAction(a.negative_feedback_action_type)}):null},_shouldRenderNFXAction:function(a){switch(a){case"UNTAG":case"UNTAG_SPONSOR_PAGE":return!0;default:return!1}},isLandscape:function(a){var b;a=this.getMedia(a);return(a==null?void 0:(b=a.image)==null?void 0:b.height)<(a==null?void 0:(b=a.image)==null?void 0:b.width)},getStoryOverlays:function(a){return((a=a)!=null?a.story_overlays:a)||[]},getPoll:function(a){a=this.getStoryOverlays(a).find(function(a){return a.__typename==="StoryOverlayPollSticker"});return!a?null:(a=a)!=null?a.poll:a},getStoryViewerId:function(a){return(a=a)!=null?(a=a.node)!=null?a.id:a:a},getStoryViewerSeenTime:function(a){return((a=a)!=null?a.seen_time:a)||0},getSeenReceiptsLastSeenTime:function(a){return((a=a)!=null?(a=a.story_card_seen_state)!=null?a.seen_receipts_last_seen_time:a:a)||0},getNonFriendsSeenCount:function(a){return((a=a)!=null?(a=a.story_card_seen_state)!=null?(a=a.seen_receipent_seen_followers)!=null?a.count:a:a:a)||0},getfriendsSeenCount:function(a){return((a=a)!=null?(a=a.story_card_seen_state)!=null?(a=a.seen_receipent_seen_friends)!=null?a.count:a:a:a)||0},getThreadViewers:function(a,c){var d=this,e={hasNewViewers:!1,hasNewFriendViewers:!1,hasNewConnectionsViewers:!1,friends:[],connections:[],totalCount:0,totalNew:0,nonFriendsCount:0};if(!c||!a)return e;var f=(c=a)!=null?c.isCardViewed:c;c=((c=a)!=null?(c=c.story_card_info)!=null?(c=c.story_viewers)!=null?c.edges:c:c:c)||[];var g=b("CurrentUser").getID();e=c.reduce(function(b,c){var e=d.getStoryViewerId(c);if(!e)return b;if(e!==g){e=((e=c)!=null?(e=e.node)!=null?e.is_viewer_friend:e:e)||!1;var h=e?"friends":"connections",i=d.getStoryViewerSeenTime(c),j=d.getStoryViewerReactions(c),k=i>=d.getSeenReceiptsLastSeenTime(a);b[h].push(babelHelpers["extends"]({},c.node,{seenTime:i,isNewViewer:k,reactions:j}));b.totalNew+=k?1:0;b.hasNewViewers=(b.hasNewViewers||k)&&!f;b.hasNewFriendViewers=b.hasNewFriendViewers||k&&e;b.hasNewConnectionsViewers=b.hasNewViewers||k&&!e}return b},e);var h=this.getNonFriendsSeenCount(a);return Object.assign(e,{totalCount:h+c.length,nonFriendsCount:h})},getStoryViewerReactions:function(a){var b;a=((a=a)!=null?(a=a.feedback)!=null?a.lightweight_reactions:a:a)||[];a=a&&a.length>0?((b=a[0])!=null?(b=b.messaging_actions)!=null?b.nodes:b:b)||[]:[];return a.map(function(a){return a.reaction})},getAllowedNavigationType:function(a,b){var c=a===0;a=a===b-1;if(c)return"NEXT_ONLY";return a?"PREV_ONLY":"BOTH"},getCurrentCardData:function(a,b){var c=this.getActor(a),d=this.getTextFormatMetadata(a),e=null,f=null;d&&(e={body_style:d.font_style,preset_id:d.preset_id,text_input_style:d.text_input_style,swatch_style:{background_color:d.background_color,background_image:d.background_image}},f={portrait_background_image:d.portrait_background_image,portrait_keyframes_animation:d.portrait_keyframes_animation,inspirations_custom_font_object:d.inspirations_custom_font_object});d={id:c.id,name:c.name,short_name:c.short_name,gender:c.gender,is_viewer_friend:c.is_viewer_friend,profile_picture:c.profile_picture};return{activityDescription:this.getActivityDescription(a),backdropImage:this.getBackdropImage(a),bucketOwner:d,cameraPostSource:this.getCameraPostSource(a),cameraPostType:this.getCameraPostType(a),defaultBackground:this.getDefaultBackground(a),explicitLocation:this.getExplicitPlace(a),inlineActivities:this.getInlineActivities(a),isLive:!1,isPlainText:this.getIsPlainText(a),isSeen:this.isSeenByViewer(a),latestMessageID:null,linkAttachment:null,media:this.getMedia(a),mediaBackground:this.getMediaBackground(a),messageText:this.getMessageText(a),messageRanges:this.getMessageRanges(a),delightRanges:[],participants:[],textFormatMetadata:f,threadOwner:{name:c.name,id:c.id,is_viewer_friend:c.is_viewer_friend,profile_picture:c.profile_picture},time:this.getTime(a),threadID:b,originalPostStoryAttribution:this.getOriginalPostStoryAttribution(a),withTags:this.getWithTags(a),wwwTextFormatMetadata:e,negativeFeedbackActions:this.getNegativeFeedbackActions(a)}}};e.exports=a}),null);
__d("FBStoriesThreadHelper",["CameraPostMediaHelper","CameraPostThreadOwnerHelper","FBLogger","FBStoriesReactionStickerConstants","FBStoriesStoryCardHelper"],(function(a,b,c,d,e,f){"use strict";f.getId=a;f.getCameraPostType=c;f.getCameraPostSource=d;f.isSeenByViewer=g;f.notSeenByViewer=e;f.setIsSeenByViewer=h;f.getLatestMessageID=i;f.getStatus=j;f.isReviewStatusPending=k;f._getReviewStatus=l;f.getTime=m;f.getExpiryTime=n;f.isExpired=o;f.isPending=p;f.isPublished=q;f.getNonFriendsSeenCount=r;f.setNonFriendsSeenCount=s;f.getFriendsSeenCount=t;f.setFriendsSeenCount=u;f.getSeenCount=v;f.getSeenReceiptsLastSeenTime=w;f.setSeenReceiptsLastSeenTime=x;f.getSeenReceiptsUnseenCount=y;f.doesThreadHasUnseenViewers=z;f.getSeenReceiptsFollowersUnseenCount=A;f.setSeenReceiptsUnseenCount=B;f.setSeenReceiptsFollowersUnseenCount=C;f.getOwner=D;f.getOwnerId=E;f.isViewerFriendOfOwner=F;f.getViewers=G;f.setViewers=H;f.getRootMessage=I;f.getStoryOverlays=J;f.getReactionStickersReactors=K;f.getPoll=L;f.getMedia=M;f.getMediaId=N;f.getMediaType=O;f.getMediaPreviewImage=P;f.getWWWTextFormatMetadata=Q;f.getIsPlainText=R;f.getTextFormatMetadata=S;f.getBackdropImage=T;f.getMessageText=U;f.getMessageRanges=V;f.getDelightRanges=W;f.getActivityDescription=X;f.getMediaBackground=Y;f.getLinkAttachment=Z;f.getWithTags=$;f.getDefaultBackground=aa;f.getExplicitLocation=ba;f.getInlineActivities=ca;f.getOriginalPostStoryAttribution=da;f.getNegativeFeedbackActions=ea;f.getStoryViewerId=fa;f.getStoryViewerSeenTime=ga;f.getStoryViewerReactions=ha;f.makeOptimisticPhotoThread=ia;f._getDefaultThread=ja;function a(a){return((a=a)!=null?a.id:a)||""}function c(a){return((a=a)!=null?a.camera_post_type:a)||"STORY"}function d(a){return((a=a)!=null?a.post_source:a)||"CAMERA_SYSTEM"}function g(a){return!!((a=a)!=null?a.is_seen_by_viewer:a)}function e(a){return!g(a)}function h(b,a){if(!b)return;b.is_seen_by_viewer=a}function i(a){return(a=a)!=null?(a=a.latest_message)!=null?a.id:a:a}function j(a){return(a=a)!=null?a.thread_status:a}function k(a){a=l(a);return a==="PENDING"||a==="DENIED"}function l(a){return(a=a)!=null?a.thread_review_status:a}function m(a){return((a=a)!=null?a.time:a)||0}function n(a){return((a=a)!=null?a.thread_expiry_time:a)||0}function o(a){a=n(a);return!a?!1:a<Date.now()/1e3}function p(a){return j(a)==="PENDING"}function q(a){return j(a)==="PUBLISHED"}function r(a){a=((a=a)!=null?a.non_friends_seen_count:a)||0;a<0&&b("FBLogger")("fbstories").mustfix("Non friend seen count should not be negative!");return a}function s(a,b){if(!a)return;a.non_friends_seen_count=b}function t(a){return((a=a)!=null?a.friends_seen_count:a)||0}function u(a,b){if(!a)return;a.friends_seen_count=b}function v(a){return r(a)+t(a)}function w(a){return((a=a)!=null?a.seen_receipts_last_seen_time:a)||0}function x(a,b){if(!a)return;a.seen_receipts_last_seen_time=b}function y(a){return((a=a)!=null?a.seen_receipts_unseen_count:a)||0}function z(a){return!a?!1:y(a)>0||A(a)>0}function A(a){return((a=a)!=null?a.seen_receipts_followers_unseen_count:a)||0}function B(a,b){if(!a)return;a.seen_receipts_unseen_count=b}function C(a,b){if(!a)return;a.seen_receipts_followers_unseen_count=b}function D(a){return(a=a)!=null?a.camera_post_thread_owner:a}function E(a){return b("CameraPostThreadOwnerHelper").getId(D(a))}function F(a){return b("CameraPostThreadOwnerHelper").getIsViewerFriend(D(a))}function G(a){return((a=a)!=null?(a=a.story_thread_viewers)!=null?a.edges:a:a)||[]}function H(a,b){if(!a)return;a.story_thread_viewers={edges:b}}function I(a){return(a=a)!=null?a.root_message:a}function J(a){return!a?[]:((a=I(a))!=null?a.story_overlays:a)||[]}function K(a){var c={};a=this.getStoryOverlays(a)||[];a.forEach(function(a){if(a.__typename===b("FBStoriesReactionStickerConstants").StoryOverlayReactionSticker){var d,e=(d=a)!=null?(d=d.reaction_sticker)!=null?d.id:d:d,f=(d=a)!=null?(d=d.reaction_sticker)!=null?(d=d.sticker_asset)!=null?d.image_asset_url:d:d:d;a=((d=a)!=null?(d=d.reaction_sticker)!=null?(d=d.sticker_reactions)!=null?d.nodes:d:d:d)||[];a.forEach(function(a){a=a.reactor.id;c[a]?c[a].push({stickerID:e,imgURL:f}):c[a]=[{stickerID:e,imgURL:f}]})}});return c}function L(a){a=this.getStoryOverlays(a).find(function(a){return a.__typename==="StoryOverlayPollSticker"});return!a?null:(a=a)!=null?a.poll:a}function M(a){return(a=I(a))!=null?a.message_media:a}function N(a){return b("CameraPostMediaHelper").getId(M(a))}function O(a){return b("CameraPostMediaHelper").getType(M(a))}function P(a){return b("CameraPostMediaHelper").getPreviewImage(M(a))}function Q(a){return((a=I(a))!=null?a.www_text_format_metadata:a)||null}function R(a){return((a=I(a))!=null?a.is_plain_text:a)||!1}function S(a){return((a=I(a))!=null?a.text_format_metadata:a)||null}function T(a){return((a=I(a))!=null?a.backdrop_image:a)||null}function U(a){return((a=I(a))!=null?a.message_text:a)||""}function V(a){return((a=I(a))!=null?a.message_ranges:a)||null}function W(a){return((a=I(a))!=null?a.delight_ranges:a)||[]}function X(a){return!a?null:a.activity_description||null}function Y(a){if(!a)return null;a=(a=a.background_color_info)!=null?a.color_info:a;return a&&a.length>0?a[0]:null}function Z(a){return!a?null:a.share_story_attachment||null}function $(a){return!a?null:a.with_tags||null}function aa(a){return!a?null:a.story_default_background||null}function ba(a){return!a?null:a.explicit_place||null}function ca(a){return!a?null:a.inline_activities||null}function da(a){return!a?null:((a=I(a))!=null?a.original_post_story_attribution:a)||null}function ea(a){return b("FBStoriesStoryCardHelper").getNegativeFeedbackActions(a)}function fa(a){return(a=a)!=null?(a=a.node)!=null?a.id:a:a}function ga(a){return((a=a)!=null?a.seen_time:a)||0}function ha(a){var b;a=((a=a)!=null?(a=a.feedback)!=null?a.lightweight_reactions:a:a)||[];a=a&&a.length>0?((b=a[0])!=null?(b=b.messaging_actions)!=null?b.nodes:b:b)||[]:[];return a.map(function(a){return a.reaction})}function ia(a){var c=this._getDefaultThread();a=b("CameraPostMediaHelper").makeOptimisticPhotoMedia(a);return babelHelpers["extends"]({},c,{is_seen_by_viewer:!1,root_message:{message_media:a},thread_expiry_time:Math.floor(Date.now()/1e3+24*60*60),thread_status:"UPLOADING",time:Math.floor(Date.now()/1e3)})}function ja(){return{id:null,camera_post_type:null,post_source:null,time:null,thread_expiry_time:null,seen_receipts_last_seen_time:null,seen_receipts_unseen_count:null,seen_receipts_followers_unseen_count:null,thread_status:null,thread_review_status:null,root_message:{message_media:null,delight_ranges:[]},latest_message:{id:null},is_seen_by_viewer:null,is_user_story_thread_viewer:null,camera_post_thread_owner:null,friends_seen_count:null,non_friends_seen_count:null,story_thread_viewers:{edges:null},activity_description:null}}}),null);
__d("FBStoriesBucketHelper",["CameraPostBucketOwnerHelper","CameraPostTypesHelper","CurrentUser","FBStoriesLoggingConstants","FBStoriesThreadHelper"],(function(a,b,c,d,e,f){"use strict";var g={getUnseenThread:function(a){var b=h.getThreads(a);return b[Math.max(0,h.getUnseenThreadIndex(a))]}},h={isUserBucket:function(a){return h.getOwnerId(a)===b("CurrentUser").getID()},getLiveVideo:function(a){return(a=a)!=null?a.live_video:a},getMediaIDForLiveBucket:function(a){return(a=a)!=null?(a=a.live_video)!=null?a.id:a:a},isLive:function(a){return!!((a=h.getLiveVideo(a))!=null?a.id:a)},setLiveVideo:function(a,b){if(!a)return;a.live_video=b},hasData:function(a){return!a?!1:this.isLive(a)||h.getThreads(a).length>0},getThreads:function(a){a=((a=a)!=null?(a=a.threads)!=null?a.nodes:a:a)||[];return a.filter(function(a){return b("FBStoriesThreadHelper").isPublished(a)&&!b("FBStoriesThreadHelper").isExpired(a)})},getPendingThreads:function(a){return((a=a)!=null?(a=a.pending_threads)!=null?a.nodes:a:a)||[]},getThreadIDs:function(a){a=h.getThreads(a);return a.map(function(a){return((a=a)!=null?a.id:a)||""})},setThreads:function(a,b){if(!a)return;a.threads={nodes:b}},setPendingThreads:function(a,b){if(!a)return;a.pending_threads={nodes:b}},hasPendingThreads:function(a){if(!a.pending_stories)return!1;a=(a=a)!=null?(a=a.pending_stories)!=null?a.count:a:a;return!a?!1:a>0},getUnseenThreadIndex:function(a){var c=h.getThreads(a);a=h.isUserBucket(a);return a?c.findIndex(b("FBStoriesThreadHelper").doesThreadHasUnseenViewers):c.findIndex(b("FBStoriesThreadHelper").notSeenByViewer)},hasNewViewers:function(a){if(!a)return!1;a=this.getThreads(a);a=a.filter(b("FBStoriesThreadHelper").doesThreadHasUnseenViewers);return a.length>0},hasUnseenThreads:function(a){return this.getThreads(a).findIndex(b("FBStoriesThreadHelper").notSeenByViewer)>=0},getPreviewImage:function(a){a=g.getUnseenThread(a);return b("FBStoriesThreadHelper").getMediaPreviewImage(a)},getId:function(a){return((a=a)!=null?a.id:a)||""},getCameraPostType:function(a){return((a=a)!=null?a.camera_post_type:a)||"STORY"},getUnseenCount:function(a){return((a=a)!=null?a.unseen_count:a)||0},setUnseenCount:function(a,b){if(!a)return;a.unseen_count=b},hasLiveVideoEnded:function(a){return!!((a=a)!=null?a.has_live_video_ended:a)},setHasLiveVideoEnded:function(a,b){if(!a)return;a.has_live_video_ended=b},getOwner:function(a){return((a=a)!=null?a.camera_post_bucket_owner:a)||{id:null,name:null,short_name:null,gender:null,is_viewer_friend:!1,profile_picture:null}},getOwnerId:function(a){return b("CameraPostBucketOwnerHelper").getId(h.getOwner(a))},getOwnerGender:function(a){return b("CameraPostBucketOwnerHelper").getGender(h.getOwner(a))},isOwnerEmployee:function(a){return b("CameraPostBucketOwnerHelper").isEmployee(h.getOwner(a))},isViewerEventHost:function(a){return b("CameraPostBucketOwnerHelper").isEventHost(h.getOwner(a))},isViewerPageContentAdmin:function(a){return b("CameraPostBucketOwnerHelper").isViewerPageContentAdmin(h.getOwner(a))},isViewerGroupAdmin:function(a){return b("CameraPostBucketOwnerHelper").isViewerGroupAdmin(h.getOwner(a))},isViewerGroupModerator:function(a){return b("CameraPostBucketOwnerHelper").isViewerGroupModerator(h.getOwner(a))},isViewerFriendOfOwner:function(a){return b("CameraPostBucketOwnerHelper").isViewerFriend(h.getOwner(a))},getOwnerProfilePictureUri:function(a){return b("CameraPostBucketOwnerHelper").getProfilePictureUri(h.getOwner(a))},getOwnerCoverPhotoUri:function(a){return b("CameraPostBucketOwnerHelper").getCoverPhotoUri(h.getOwner(a))},getOwnerName:function(a,c){c===void 0&&(c=!1);var d=h.getCameraPostType(a);a=h.getOwner(a);if(!c&&b("CameraPostTypesHelper").isStory(d)&&a.short_name)return a.short_name;else return a.name},getLatestThreadCreationTime:function(a){return!a?null:(a=a)!=null?a.latest_thread_creation_time:a},getLoggingType:function(a){if(!a)return b("FBStoriesLoggingConstants").MISSING_STORY_DATA;if(h.isUserBucket(a))return b("FBStoriesLoggingConstants").SELF_STORY;var c=h.getCameraPostType(a);if(b("CameraPostTypesHelper").isPageStory(c))return b("FBStoriesLoggingConstants").PAGE_STORY;if(b("CameraPostTypesHelper").isGroupStory(c))return b("FBStoriesLoggingConstants").GROUP_STORY;if(b("CameraPostTypesHelper").isEventStory(c))return b("FBStoriesLoggingConstants").EVENT_STORY;if(b("CameraPostTypesHelper").isPromotionStory(c))return b("FBStoriesLoggingConstants").STORY_PROMOTION;return!h.isViewerFriendOfOwner(a)?b("FBStoriesLoggingConstants").FOLLOWEE_STORY:b("FBStoriesLoggingConstants").FRIEND_STORY},addThreadToBucket:function(a,b){var c=h.getThreads(a);h.setThreads(a,c.concat(b))},getDefaultBucket:function(){return{id:null,camera_post_type:null,unseen_count:0,ranking:null,live_video:null,camera_post_bucket_owner:null,threads:null,pending_threads:null,latest_thread_creation_time:null}},isUploading:function(a){if(!a)return!1;a=(a=a)!=null?a.is_uploading:a;return!!a},setUploading:function(a,b){if(!a)return;a.is_uploading=b}};a=h;e.exports=a}),null);
__d("FBStoriesLiveVideoActionTypes",["keyMirror"],(function(a,b,c,d,e,f){a=b("keyMirror")({SET_UI_COMPONENTS:null,REMOVE_UI_COMPONENTS:null,LIVE_BUCKET_LOADED:null,LOAD_UI_COMPONENTS_FAILED:null});e.exports=a}),null);
__d("FBStoriesMutedBucketOwnerHelper",[],(function(a,b,c,d,e,f){"use strict";f.getId=a;f.getName=b;f.getProfilePictureUri=c;f.getMuted=d;f.setMuted=e;function a(a){return((a=a)!=null?a.id:a)||""}function b(a){return((a=a)!=null?a.name:a)||""}function c(a){return((a=a)!=null?a.profilePictureUri:a)||""}function d(a){return!!((a=a)!=null?a.muted:a)}function e(a,b){a.muted=b}}),null);
__d("FBStoriesMutedBucketOwnersActionTypes",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({LOADING:"FB_STORIES_MUTED_BUCKET_OWNERS.LOADING",LOADED:"FB_STORIES_MUTED_BUCKET_OWNERS.LOADED",LOADED_ERROR:"FB_STORIES_MUTED_BUCKET_OWNERS.LOADED_ERROR",SET_IS_CURRENTLY_MUTING:"FB_STORIES_MUTED_BUCKET_OWNERS.SET_IS_CURRENTLY_MUTING",UPDATE_MUTED_OPTIMISTIC:"FB_STORIES_MUTED_BUCKET_OWNERS.UPDATE_MUTED_OPTIMISTIC"});e.exports=a}),null);
__d("fbStoriesMutedBucketOwnersSelectors",[],(function(a,b,c,d,e,f){"use strict";f.isLoading=a;f.getMutedBucketOwners=b;f.getCurrentlyMutingBucketOwners=g;f.isCurrentlyMutingBucketOwners=c;f.canReload=d;function a(a){return a.data.isLoading()}function b(a){a=a.data;return a.hasValue()?a.getValueEnforcing():[]}function g(a){return a.currentlyMutingBucketOwners}function c(a){return g(a).length!==0}function d(a){return!this.isCurrentlyMutingBucketOwners(a)&&!this.isLoading(a)}}),null);
__d("fbStoriesMutedBucketOwnersReducer",["FBStoriesMutedBucketOwnerHelper","FBStoriesMutedBucketOwnersActionTypes","LoadObject","fbStoriesMutedBucketOwnersSelectors"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a,c){switch(c.type){case b("FBStoriesMutedBucketOwnersActionTypes").LOADING:return babelHelpers["extends"]({},a,{data:b("LoadObject").loading()});case b("FBStoriesMutedBucketOwnersActionTypes").LOADED:return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue(c.data),currentlyMutingBucketOwners:[]});case b("FBStoriesMutedBucketOwnersActionTypes").LOADED_ERROR:return babelHelpers["extends"]({},a,{data:b("LoadObject").withError(new Error(c.error.errorSummary))});case b("FBStoriesMutedBucketOwnersActionTypes").SET_IS_CURRENTLY_MUTING:var d=a.currentlyMutingBucketOwners,e=a.currentlyMutingBucketOwners.indexOf(c.ownerID);c.value&&e===-1?(d=d.slice(),d.push(c.ownerID)):!c.value&&e!==-1&&(d=d.slice(),d.splice(e,1));return babelHelpers["extends"]({},a,{currentlyMutingBucketOwners:d});case b("FBStoriesMutedBucketOwnersActionTypes").UPDATE_MUTED_OPTIMISTIC:e=b("fbStoriesMutedBucketOwnersSelectors").getMutedBucketOwners(a);var f=c.value;d=!1;var g=e.map(function(a){if(b("FBStoriesMutedBucketOwnerHelper").getId(a)===c.ownerID){var e=babelHelpers["extends"]({},a);d=!0;b("FBStoriesMutedBucketOwnerHelper").setMuted(e,f);return e}else return a});d||(g=e.concat({id:c.ownerID,name:c.ownerName,profilePictureUri:c.ownerProfilePictureUri,muted:f}));return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue(g)});default:return a}}}),null);
__d("FBStoriesMutedBucketOwnersStore",["FBStoriesDispatcher","FluxReduceStore","LoadObject","fbStoriesMutedBucketOwnersReducer"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{data:b("LoadObject").empty(),currentlyMutingBucketOwners:[]}};d.reduce=function(a,c){return b("fbStoriesMutedBucketOwnersReducer")(a,c)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("FBStoriesDispatcher"));e.exports=c}),null);
__d("fbStoriesRootSelectors",["FBStoriesBucketHelper","reselect"],(function(a,b,c,d,e,f){"use strict";a=b("reselect").createSelector;var g=function(a,b,c){return c===0?a:(a=b)!=null?a[c-1]:a};c=function(a){return a.data};d=a([c],function(a){return a.hasValue()?a.getValueEnforcing():{friendsBucketData:[],userBucketData:b("FBStoriesBucketHelper").getDefaultBucket(),userInfo:{userName:"",userID:"",userGender:"",userProfilePic:{uri:""}}}});e=a(c,function(a){return a.isLoading()});f.loading=e;c=a([d],function(a){return a.userBucketData||{}});f.userBucketData=c;e=a([c],function(a){return a&&a.id});var h=a([d],function(a){return a.friendsBucketData||[]});f.friendsBucketData=h;var i=a([h],function(a){return a.map(function(a){return a.id?a.id:""})});f.friendsBucketIds=i;i=a([i,e],function(a,b){return[b].concat(a)});f.bucketIds=i;e=a([d],function(a){return a.userInfo||{}});f.userInfo=e;i=function(a){return a.selectedBucketIndex};d=a([i,c,h],function(b,c,a){return g(c,a,b)});f.selectedBucket=d;e=a([d],function(a){return a&&a.id});f.selectedBucketId=e;i=a(c,function(a){return b("FBStoriesBucketHelper").isUploading(a)});f.uploading=i;d=a([h,c],function(a,c){c=[c].concat(a);return c.reduce(function(a,c){if(!c||!c.id)return a;if(!b("FBStoriesBucketHelper").hasData(c))return a;c={bucketID:b("FBStoriesBucketHelper").getId(c),cameraPostType:b("FBStoriesBucketHelper").getCameraPostType(c),owner:b("FBStoriesBucketHelper").getOwner(c),previewImageUri:b("FBStoriesBucketHelper").getPreviewImage(c),profileImageUri:b("FBStoriesBucketHelper").getOwnerProfilePictureUri(c),hasUnseenThreads:b("FBStoriesBucketHelper").hasUnseenThreads(c),hasNewViewers:b("FBStoriesBucketHelper").hasNewViewers(c),ownedByViewer:b("FBStoriesBucketHelper").isUserBucket(c),isLive:b("FBStoriesBucketHelper").isLive(c),latestThreadCreationTime:b("FBStoriesBucketHelper").getLatestThreadCreationTime(c),actorName:b("FBStoriesBucketHelper").getOwnerName(c,!0),actorShortName:b("FBStoriesBucketHelper").getOwnerName(c),actorGender:b("FBStoriesBucketHelper").getOwnerGender(c)};return a.concat([c])},[])});f.bucketDescriptors=d}),null);
__d("fbStoriesStateSelectors",["FBStoriesBucketHelper","fbStoriesRootSelectors"],(function(a,b,c,d,e,f){"use strict";a=function(a,b){b=h(a,b);return g(a,b)};f.bucketByBucketId=a;var g=function(a,c){return c===0?b("fbStoriesRootSelectors").userBucketData(a):(a=b("fbStoriesRootSelectors").friendsBucketData(a))!=null?a[c-1]:a};f.bucketByIndex=g;var h=function(a,c){a=b("fbStoriesRootSelectors").bucketIds(a);return a.indexOf(c)};f.bucketIndexByBucketId=h;c=function(a,c){return(c!=void 0?c:b("fbStoriesRootSelectors").selectedBucketId(a))===b("FBStoriesBucketHelper").getId(b("fbStoriesRootSelectors").userBucketData(a))};f.isOwnBucket=c;d=function(a){return a.isProductionDialogLoading};f.isProductionDialogLoading=d}),null);
__d("friendsBucketSorter",["CameraPostTypesHelper"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){return function(b,c){var d=b.live_video&&b.live_video.id,e=c.live_video&&c.live_video.id;if(d!==e)return d?-1:1;if(g(b,c))return i(b)?-1:1;if(h(b,c))return j(b)?-1:1;if(k(b,c,a))return l(b,a)?-1:1;e=n(b);d=n(c);return e===d?0:e>d?-1:1}}function g(a,b){return m(a,b,i)}function h(a,b){return m(a,b,j)}function i(a){return a.unseen_count>0}function j(a){return b("CameraPostTypesHelper").isEventStory(a.camera_post_type)}function k(a,b,c){return l(a,c)!==l(b,c)}function l(a,b){a=((a=a)!=null?(a=a.threads)!=null?a.nodes:a:a)||[];for(var c=0;c<a.length;c++){var d;d=(d=a[c])!=null?(d=d.camera_post_thread_owner)!=null?d.id:d:d;if(d===b)return!0}return!1}function m(a,b,c){a=c(a);c=c(b);return a!=c}function n(a){return((a=a)!=null?(a=a.ranking)!=null?a.score:a:a)||0}}),null);
__d("FBStoriesStore",["CameraPostMediaHelper","FBStoriesActionTypes","FBStoriesBucketHelper","FBStoriesDataHelper","FBStoriesDispatcher","FBStoriesGating","FBStoriesLiveVideoActionTypes","FBStoriesMutedBucketOwnersStore","FBStoriesReactionStickerConstants","FBStoriesThreadHelper","FluxReduceStore","LoadObject","fbStoriesMutedBucketOwnersSelectors","fbStoriesRootSelectors","fbStoriesStateSelectors","friendsBucketSorter"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{data:b("LoadObject").empty(),selectedBucketIndex:-1,currentThreadIndex:-1,currentThreadPercentDone:0,unseenMode:!1,allBucketsViewed:!1,lastViewedThreadIndexForBucket:new Map(),isProductionDialogLoading:!1,isCommercialBreakRunning:new Map(),isViewerOpen:!1,subscriptionToken:null,viewerEntrypoint:null}};d.reduce=function(a,c){var d=this;switch(c.type){case b("FBStoriesActionTypes").LOADING:return babelHelpers["extends"]({},a,{data:b("LoadObject").loading()});case b("FBStoriesActionTypes").LOADED:var e=c.data,f=e.userInfo;e=e.userBucketData;var g=c.data.friendsBucketData;g=b("FBStoriesDataHelper").getFriendsDataWithEndedLiveBucket(g,this.$FBStoriesStore1(),this.isOwnBucket(this.getSelectedBucketId()));return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userInfo:f,userBucketData:e,friendsBucketData:g})});case b("FBStoriesActionTypes").VIEWER_LIST_LOADED_FOR_THREAD:var h=c.data.node;f=babelHelpers["extends"]({},this.getUserBucketData(),{threads:{nodes:this.$FBStoriesStore2().map(function(a){if(b("FBStoriesThreadHelper").getId(a)===c.threadID){var d,e=babelHelpers["extends"]({},a);(d=b("FBStoriesThreadHelper")).setFriendsSeenCount(e,d.getFriendsSeenCount(h));d.setNonFriendsSeenCount(e,d.getNonFriendsSeenCount(h));d.setViewers(e,d.getViewers(h));return e}return a})}});return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:f,userInfo:this.getUserInfo(),friendsBucketData:this.getFriendsBucketData()})});case b("FBStoriesActionTypes").SUBSCRIPTION_BUCKET_UPDATE:var i=c.bucketData;e=b("FBStoriesBucketHelper").getOwnerId(i);if(this.isMutedBucketOwner(e))return a;g=b("FBStoriesBucketHelper").getThreads(i);var j=g.length>0||this.$FBStoriesStore3(i),k=b("FBStoriesBucketHelper").getId(i);f=b("fbStoriesRootSelectors").friendsBucketData(a);e=!1;g=f.reduce(function(a,c){b("FBStoriesBucketHelper").getId(c)===k?(e=!0,j&&a.push(i)):a.push(c);return a},[]);!e&&j&&(g=[i].concat(f));g=b("FBStoriesDataHelper").getFriendsDataWithEndedLiveBucket(g,b("fbStoriesRootSelectors").selectedBucket(a),b("fbStoriesStateSelectors").isOwnBucket(a,b("fbStoriesRootSelectors").selectedBucketId(a)));f=b("FBStoriesGating").shouldUseTrayMigration();f||g.sort(b("friendsBucketSorter")(b("fbStoriesRootSelectors").userInfo(a).userID));return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:b("fbStoriesRootSelectors").userBucketData(a),userInfo:b("fbStoriesRootSelectors").userInfo(a),friendsBucketData:g})});case b("FBStoriesActionTypes").LOADED_ERROR:return babelHelpers["extends"]({},a,{data:b("LoadObject").withError(new Error(c.error.message))});case b("FBStoriesActionTypes").RESET_LOCAL_SEEN_HISTORY:return babelHelpers["extends"]({},a,{lastViewedThreadIndexForBucket:new Map()});case b("FBStoriesActionTypes").SELECTED_BUCKET_IDX_CHANGED:f=c.bucketIndex;return f<0||f>=this.getBucketCount()?a:babelHelpers["extends"]({},a,{selectedBucketIndex:f});case b("FBStoriesActionTypes").SELECTED_THREAD_IDX_CHANGED:g=this.getThreadCountForSelectedBucket();if(!this.isSelectedBucketLive()&&(c.index<0||c.index>=g))return a;f=new Map(a.lastViewedThreadIndexForBucket);f.set(this.getSelectedBucketIndex(),c.index);return babelHelpers["extends"]({},a,{lastViewedThreadIndexForBucket:f,currentThreadIndex:c.index});case b("FBStoriesActionTypes").SELECTED_THREAD_PERCENT_DONE:g=Math.min(100,Math.max(c.percentDone,0));return babelHelpers["extends"]({},a,{currentThreadPercentDone:g});case b("FBStoriesActionTypes").SET_ALL_BUCKETS_VIEWED:f=c.value;return f===a.allBucketsViewed?a:babelHelpers["extends"]({},a,{allBucketsViewed:f,unseenMode:a.unseenMode&&f?!1:a.unseenMode});case b("FBStoriesActionTypes").SET_UNSEEN_MODE:return babelHelpers["extends"]({},a,{unseenMode:c.value});case b("FBStoriesActionTypes").UPDATE_THREAD_SEEN_OPTIMISTIC:var l=this.getSelectedBucketId()?this.getSelectedBucketId():c.bucketID;g=function(a){if(b("FBStoriesBucketHelper").getId(a)===l){var e=b("FBStoriesBucketHelper").getUnseenCount(a),f=d.$FBStoriesStore4(a).map(function(a){if(b("FBStoriesThreadHelper").getId(a)===c.threadID){b("FBStoriesThreadHelper").isSeenByViewer(a)||(e=Math.max(e-1,0));var d=babelHelpers["extends"]({},a);b("FBStoriesThreadHelper").setIsSeenByViewer(d,!0);return d}else return a}),g=babelHelpers["extends"]({},a);b("FBStoriesBucketHelper").setUnseenCount(g,e);b("FBStoriesBucketHelper").setThreads(g,f);return g}else return a};f=this.isOwnBucket()?g(this.getUserBucketData()):this.getUserBucketData();g=this.isOwnBucket()?this.getFriendsBucketData():this.getFriendsBucketData().map(g);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:f,friendsBucketData:g,userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:f=babelHelpers["extends"]({},this.getUserBucketData(),{threads:{nodes:this.$FBStoriesStore2().map(function(a){if(b("FBStoriesThreadHelper").getId(a)===c.threadID){var d=babelHelpers["extends"]({},a);b("FBStoriesThreadHelper").setSeenReceiptsLastSeenTime(d,Date.now());b("FBStoriesThreadHelper").setSeenReceiptsUnseenCount(d,0);b("FBStoriesThreadHelper").setSeenReceiptsFollowersUnseenCount(d,0);return d}else return a})}});return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:f,userInfo:this.getUserInfo(),friendsBucketData:this.getFriendsBucketData()})});case b("FBStoriesActionTypes").DELETE_THREAD_FROM_BUCKET:var m=c.threadID,n=c.bucketID;if(!this.isUserManagedThread(m,n))return a;g=this.getUserBucketData();f=null;n===b("FBStoriesBucketHelper").getId(g)?(b("FBStoriesBucketHelper").setThreads(g,this.$FBStoriesStore4(g).filter(function(a){return b("FBStoriesThreadHelper").getId(a)!==m})),f=this.getFriendsBucketData()):f=this.getFriendsBucketData().map(function(a){if(b("FBStoriesBucketHelper").getId(a)===n){var c=d.$FBStoriesStore4(a).filter(function(a){return b("FBStoriesThreadHelper").getId(a)!==m}),e=babelHelpers["extends"]({},a);b("FBStoriesBucketHelper").setThreads(e,c);return e}else return a}).filter(function(a){return d.$FBStoriesStore4(a).length>0});var o=a.lastViewedThreadIndexForBucket;m===this.getCurrentThreadIDForSelectedBucket()&&(o=new Map(o),o.set(this.getSelectedBucketIndex(),void 0));return babelHelpers["extends"]({},a,{lastViewedThreadIndexForBucket:o,data:b("LoadObject").withValue({userBucketData:g,friendsBucketData:f,userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").REMOVE_BUCKET:var p=c.bucketID;o=this.getFriendsBucketData().filter(function(a){return b("FBStoriesBucketHelper").getId(a)!==p});return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:this.getUserBucketData(),friendsBucketData:o,userInfo:this.getUserInfo()})});case b("FBStoriesLiveVideoActionTypes").LIVE_BUCKET_LOADED:g=c.data;f=b("FBStoriesDataHelper").getFriendsBucketDataFromLoadedObject(g);o=[].concat(this.getFriendsBucketData());g=f.reduce(function(a,c){d.$FBStoriesStore3(c)&&d.getBucketIndexByBucketId(b("FBStoriesBucketHelper").getId(c))===-1&&a.push(c);return a},o);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:g})});case b("FBStoriesActionTypes").REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:var q=c.bucketID;f=this.getFriendsBucketData().map(function(a){b("FBStoriesBucketHelper").getId(a)===q&&(b("FBStoriesBucketHelper").setLiveVideo(a,null),b("FBStoriesBucketHelper").setHasLiveVideoEnded(a,!1));return a});return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:this.getUserBucketData(),friendsBucketData:f,userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").SET_IS_COMMERCIAL_BREAK_RUNNING:o=new Map(this.getState().isCommercialBreakRunning);return babelHelpers["extends"]({},a,{isCommercialBreakRunning:o.set(c.videoID,c.isCommercialBreakRunning)});case b("FBStoriesActionTypes").UNSELECT_BUCKET:return babelHelpers["extends"]({},a,{selectedBucketIndex:-1,currentThreadIndex:-1});case b("FBStoriesActionTypes").SET_VIEWER_OPEN:return babelHelpers["extends"]({},a,{isViewerOpen:c.value,viewerEntrypoint:c.entrypoint});case b("FBStoriesActionTypes").SET_USER_BUCKET_UPLOAD_STATUS:g=babelHelpers["extends"]({},this.getUserBucketData());b("FBStoriesBucketHelper").setUploading(g,c.isUploading);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:g,friendsBucketData:this.getFriendsBucketData(),userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").OPTIMISTIC_CREATE_PHOTO_STORY:f=b("FBStoriesThreadHelper").makeOptimisticPhotoThread(c.imageURL);o=babelHelpers["extends"]({},this.getUserBucketData());b("FBStoriesBucketHelper").addThreadToBucket(o,f);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:o,friendsBucketData:this.getFriendsBucketData(),userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").RESET_STATE:return babelHelpers["extends"]({},this.getInitialState());case b("FBStoriesActionTypes").SET_SUBSCRIPTION_TOKEN:return babelHelpers["extends"]({},a,{subscriptionToken:c.token});case b("FBStoriesActionTypes").OPTIMISTIC_POLL_VOTE:var r=c.index,s=this.getSelectedBucketId();g=function(a){if(b("FBStoriesBucketHelper").getId(a)===s){var c=d.$FBStoriesStore4(a).map(function(a){if(b("FBStoriesThreadHelper").getId(a)===d.getCurrentThreadIDForSelectedBucket()){var c,e=babelHelpers["extends"]({},a);(((c=e)!=null?(c=c.root_message)!=null?c.story_overlays:c:c)||[]).map(function(a){if(a.__typename==="StoryOverlayPollSticker"){var b=a.poll,c=babelHelpers["extends"]({},b);c.viewer_vote_index=r;c.poll_options=[].concat(b.poll_options);b=c.poll_options[r];b!==void 0&&(b.vote_count+=1);a.poll=c}return a});return e}else return a}),e=babelHelpers["extends"]({},a);b("FBStoriesBucketHelper").setThreads(e,c);return e}else return a};f=this.isOwnBucket()?g(this.getUserBucketData()):this.getUserBucketData();o=this.isOwnBucket()?this.getFriendsBucketData():this.getFriendsBucketData().map(g);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:f,friendsBucketData:o,userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").TAP_ON_REACTION_STICKER:var t=c.stickerID,u=c.count,v=this.getUserInfo().userID,w=!1,x=this.getSelectedBucketId();g=function(a){if(b("FBStoriesBucketHelper").getId(a)===x){var c=d.$FBStoriesStore4(a).map(function(a){if(b("FBStoriesThreadHelper").getId(a)===d.getCurrentThreadIDForSelectedBucket()){var c,e=babelHelpers["extends"]({},a);(((c=e)!=null?(c=c.root_message)!=null?c.story_overlays:c:c)||[]).map(function(a){if(a.__typename===b("FBStoriesReactionStickerConstants").StoryOverlayReactionSticker&&a.reaction_sticker.id===t){var c=a.reaction_sticker.sticker_reactions.nodes;for(var d=c,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;if(v===g.reactor.id){g.reaction_count+=u;w=!0;break}}w||c.push({reaction_count:u,reactor:{id:v}})}return a});return e}else return a}),e=babelHelpers["extends"]({},a);b("FBStoriesBucketHelper").setThreads(e,c);return e}else return a};f=this.isOwnBucket()?g(this.getUserBucketData()):this.getUserBucketData();o=this.isOwnBucket()?this.getFriendsBucketData():this.getFriendsBucketData().map(g);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:f,friendsBucketData:o,userInfo:this.getUserInfo()})});case b("FBStoriesActionTypes").SET_IS_PRODUCTION_DIALOG_LOADING:return babelHelpers["extends"]({},a,{isProductionDialogLoading:c.value});case b("FBStoriesActionTypes").APPROVE_PENDING_THREAD:var y=c.bucketID,z=c.threadID;g=this.getFriendsBucketData().map(function(a){if(b("FBStoriesBucketHelper").getId(a)===y){var c=b("FBStoriesBucketHelper").getPendingThreads(a),e=c.findIndex(function(a){return b("FBStoriesThreadHelper").getId(a)===z});if(e===-1)return a;var f=c[e];c.splice(e,1);b("FBStoriesBucketHelper").setPendingThreads(a,c);e=b("FBStoriesThreadHelper").getTime(f);c=d.$FBStoriesStore4(a);var g=0;if(c.length===0)c.push(f);else for(g=c.length-1;g>=0;g--){var h=b("FBStoriesThreadHelper").getTime(c[g]);if(e>h){c.splice(g+1,0,f);break}else g===0&&c.splice(0,0,f)}b("FBStoriesBucketHelper").setThreads(a,c);h=babelHelpers["extends"]({},a);return h}return a});return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({userBucketData:this.getUserBucketData(),friendsBucketData:g,userInfo:this.getUserInfo()})});default:return a}};d.$FBStoriesStore5=function(){var a=this.getState().data;return a.hasValue()?a.getValueEnforcing():{friendsBucketData:[],userBucketData:b("FBStoriesBucketHelper").getDefaultBucket(),userInfo:{userName:"",userID:"",userGender:"",userProfilePic:{uri:""}}}};d.getUserBucketData=function(){return this.$FBStoriesStore5().userBucketData||{}};d.getUserInfo=function(){return this.$FBStoriesStore5().userInfo||{}};d.getFriendsBucketData=function(){return this.$FBStoriesStore5().friendsBucketData||[]};d.isMutedBucketOwner=function(a){var c=b("FBStoriesMutedBucketOwnersStore").getState();c=b("fbStoriesMutedBucketOwnersSelectors").getMutedBucketOwners(c);return c.find(function(b){return b.id===a})!==void 0};d.isLoading=function(){return this.getState().data.isLoading()};d.getBucketIds=function(){var a=this.getFriendsBucketData().map(function(a){return a.id?a.id:""}),b=this.getUserBucketData().id||"";return[b].concat(a)};d.getSelectedBucketIndex=function(){return this.getState().selectedBucketIndex};d.getSelectedBucketId=function(){return this.getBucketIds()[this.getSelectedBucketIndex()]};d.areAllBucketsViewed=function(){return this.getState().allBucketsViewed};d.getCameraPostTypeForBucketId=function(a){return b("FBStoriesBucketHelper").getCameraPostType(this.$FBStoriesStore6(a))};d.doesBucketContainThreadId=function(a,c){a=this.$FBStoriesStore6(a);a=b("FBStoriesBucketHelper").getThreads(a);return a.find(function(a){return b("FBStoriesThreadHelper").getId(a)===c})!==void 0};d.$FBStoriesStore6=function(a){return this.getBucketByIndex(this.getBucketIndexByBucketId(a))};d.getBucketIndexByBucketId=function(a){return this.getBucketIds().indexOf(a)};d.getSelectedBucketCameraPostType=function(){return b("FBStoriesBucketHelper").getCameraPostType(this.$FBStoriesStore1())};d.getSelectedBucketOwner=function(){return b("FBStoriesBucketHelper").getOwner(this.$FBStoriesStore1())};d.getSelectedBucketOwnerID=function(){return b("FBStoriesBucketHelper").getOwnerId(this.$FBStoriesStore1())};d.getSelectedBucketUnseenCount=function(){return b("FBStoriesBucketHelper").getUnseenCount(this.$FBStoriesStore1())};d.getThreadsForSelectedBucket=function(){return this.$FBStoriesStore4(this.$FBStoriesStore1())};d.getCurrentThreadIndexForSelectedBucket=function(){return this.getState().currentThreadIndex};d.getCurrentThreadIDForSelectedBucket=function(){return b("FBStoriesThreadHelper").getId(this.getCurrentThreadForSelectedBucket())};d.getCurrentThreadStatusForSelectedBucket=function(){return b("FBStoriesThreadHelper").getStatus(this.getCurrentThreadForSelectedBucket())};d.getCurrentThreadCameraPostTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?"STORY":b("FBStoriesThreadHelper").getCameraPostType(this.getCurrentThreadForSelectedBucket())};d.getCurrentThreadMediaTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?"live":b("FBStoriesThreadHelper").getMediaType(this.getCurrentThreadForSelectedBucket())};d.getFeedTrackingData=function(a){var b={};b.is_fb_story=!0;b.media_id=this.getCurrentThreadMediaIDForSelectedBucket();b.camera_post_type=this.getSelectedBucketCameraPostType();b.story_owner_fbid=this.getSelectedBucketOwnerID();b.story_owner_type=this.getSelectedBucketOwnerType();b.story_size=this.getThreadCountForSelectedBucket();b.new_content_size=this.getSelectedBucketUnseenCount();b.bucket_index=this.getSelectedBucketIndex();b.event=a;b.bucket_ids=this.getBucketIds();a=this.getUserBucketData();a&&(b.bucket_data=a);a=this.getCurrentThreadData();a&&(b.thread_data=a);return b};d.getCurrentThreadMediaIDForSelectedBucket=function(){if(this.isSelectedBucketLive()){var a=this.getThreadDataForSelectedLiveBucket();return a&&a.media.id}return b("FBStoriesThreadHelper").getMediaId(this.getCurrentThreadForSelectedBucket())};d.getCurrentThreadMediaViewerCountForSelectedBucket=function(){var a=this.getCurrentThreadForSelectedBucket();return b("FBStoriesThreadHelper").getSeenCount(a)};d.getCurrentThreadForSelectedBucket=function(){return this.getThreadsForSelectedBucket()[this.getCurrentThreadIndexForSelectedBucket()]};d.getCurrentThreadData=function(){return this.isSelectedBucketLive()?this.getThreadDataForSelectedLiveBucket():this.$FBStoriesStore7(this.getState().currentThreadIndex)};d.shouldDisableReply=function(){var a=this.isOwnThread(),c=b("FBStoriesBucketHelper").isViewerFriendOfOwner(this.$FBStoriesStore1()),d=b("FBStoriesThreadHelper").isViewerFriendOfOwner(this.getCurrentThreadForSelectedBucket());return a||!c&&!d||this.isSelectedBucketLive()};d.getNonFriendsSeenCount=function(){return b("FBStoriesThreadHelper").getNonFriendsSeenCount(this.getCurrentThreadForSelectedBucket())};d.getFriendsSeenCount=function(){return b("FBStoriesThreadHelper").getFriendsSeenCount(this.getCurrentThreadForSelectedBucket())};d.isOwnBucket=function(a){return(a!=void 0?a:this.getSelectedBucketId())===b("FBStoriesBucketHelper").getId(this.getUserBucketData())};d.isOwnThread=function(){if(this.isOwnBucket())return!0;var a=this.getCurrentThreadForSelectedBucket();a=b("FBStoriesThreadHelper").getOwnerId(a);return a===this.getUserInfo().userID};d.isBucketViewerEventHost=function(){var a=this.$FBStoriesStore1();return b("FBStoriesBucketHelper").isViewerEventHost(a)};d.isCurrentThreadUserManaged=function(){return this.isUserManagedThread(this.getCurrentThreadIDForSelectedBucket()||"",this.getSelectedBucketId())};d.canUserReportCurrentThreadToFacebook=function(){return this.canUserReportThreadToFacebook(this.getCurrentThreadIDForSelectedBucket()||"",this.getSelectedBucketId())};d.isCurrentBucketUserManaged=function(){return this.isUserManagedBucket(this.getSelectedBucketId())};d.isUserManagedThread=function(a,c){var d=this.$FBStoriesStore6(c);if(!d)return!1;a=this.$FBStoriesStore8(a,d);d=b("FBStoriesThreadHelper").getOwnerId(a);return a&&d===this.getUserInfo().userID||this.isUserManagedBucket(c)};d.canUserReportThreadToFacebook=function(a,c){c=this.$FBStoriesStore6(c);if(!c)return!1;a=this.$FBStoriesStore8(a,c);return a===null?!1:b("FBStoriesThreadHelper").getOwnerId(a)!==this.getUserInfo().userID&&!b("FBStoriesBucketHelper").isViewerEventHost(c)&&!b("FBStoriesBucketHelper").isViewerPageContentAdmin(c)};d.isUserManagedBucket=function(a){a=this.$FBStoriesStore6(a);return!a?!1:b("FBStoriesBucketHelper").getId(a)===b("FBStoriesBucketHelper").getId(this.getUserBucketData())||b("FBStoriesBucketHelper").isViewerEventHost(a)||b("FBStoriesBucketHelper").isViewerPageContentAdmin(a)||b("FBStoriesBucketHelper").isViewerGroupModerator(a)||b("FBStoriesBucketHelper").isViewerGroupAdmin(a)};d.canSeeCurrentThreadViewCount=function(){return this.isOwnThread()&&!this.isSelectedBucketLive()||this.isCurrentBucketPageAdmin()};d.canOpenCurrentThreadViewerSheet=function(){return this.isOwnThread()&&!this.isSelectedBucketLive()};d.isCurrentBucketGroupAdmin=function(){return this.isGroupAdminBucket(this.getSelectedBucketId())};d.isCurrentBucketPageAdmin=function(){return this.isPageAdminBucket(this.getSelectedBucketId())};d.isGroupAdminBucket=function(a){a=this.$FBStoriesStore6(a);return!a?!1:b("FBStoriesBucketHelper").isViewerGroupModerator(a)||b("FBStoriesBucketHelper").isViewerGroupAdmin(a)};d.isPageAdminBucket=function(a){a=this.$FBStoriesStore6(a);return!a?!1:b("FBStoriesBucketHelper").isViewerPageContentAdmin(a)};d.isCurrentThreadReviewStatusPending=function(){var a=this.getThreadsForSelectedBucket()[this.getCurrentThreadIndexForSelectedBucket()];return b("FBStoriesThreadHelper").isReviewStatusPending(a)};d.hasPendingThreads=function(){var a=this.$FBStoriesStore6(this.getSelectedBucketId());return!a?!1:b("FBStoriesBucketHelper").hasPendingThreads(a)};d.getBucketCount=function(){return this.getFriendsBucketData().length+1};d.hasDataInSelectedBucket=function(){return b("FBStoriesBucketHelper").hasData(this.$FBStoriesStore1())};d.hasOwnBucketViewers=function(){return this.userBucketIsLive()?!1:b("FBStoriesBucketHelper").hasNewViewers(this.getUserBucketData())};d.hasOwnBucketUpdates=function(){return this.userBucketIsLive()?!1:b("FBStoriesBucketHelper").hasUnseenThreads(this.getUserBucketData())};d.hasOwnBucketContent=function(){return this.$FBStoriesStore2().length>0||this.userBucketIsLive()};d.getCurrentThreadPercentDone=function(){return this.getState().currentThreadPercentDone};d.getThreadCountForSelectedBucket=function(){return this.getThreadsForSelectedBucket().length};d.userBucketIsLive=function(){return this.$FBStoriesStore3(this.getUserBucketData())};d.isSelectedBucketLive=function(){return this.$FBStoriesStore3(this.$FBStoriesStore1())};d.getSelectedBucketOwnerType=function(){return b("FBStoriesBucketHelper").getLoggingType(this.$FBStoriesStore1())};d.$FBStoriesStore3=function(a){return b("FBStoriesBucketHelper").isLive(a)};d.getCurrentThreadViewers=function(){var a={hasNewViewers:!1,hasNewFriendViewers:!1,hasNewConnectionsViewers:!1,friends:[],connections:[],totalCount:0,totalNew:0,nonFriendsCount:0};if(!this.canSeeCurrentThreadViewCount())return a;var c=this.getCurrentThreadForSelectedBucket(),d=b("FBStoriesThreadHelper").getViewers(c),e=this.getUserInfo().userID,f=b("FBStoriesThreadHelper").getReactionStickersReactors(c);a=d.reduce(function(a,d){var g=b("FBStoriesThreadHelper").getStoryViewerId(d);if(!g)return a;if(g!==e){var h;h=((h=d)!=null?(h=h.node)!=null?h.is_viewer_friend:h:h)||!1;var i=h?"friends":"connections",j=b("FBStoriesThreadHelper").getStoryViewerSeenTime(d),k=b("FBStoriesThreadHelper").getStoryViewerReactions(d),l=j>=b("FBStoriesThreadHelper").getSeenReceiptsLastSeenTime(c);a[i].push(babelHelpers["extends"]({},d.node,{seenTime:j,isNewViewer:l,reactions:k,reactionStickers:f[g]}));a.totalNew+=l?1:0;a.hasNewViewers=a.hasNewViewers||l;a.hasNewFriendViewers=a.hasNewFriendViewers||l&&h;a.hasNewConnectionsViewers=a.hasNewViewers||l&&!h}return a},a);var g=this.getNonFriendsSeenCount();return Object.assign(a,{totalCount:g+d.length,nonFriendsCount:g})};d.isUnseenMode=function(){return this.getState().unseenMode};d.getThreadCount=function(a){var b=this.getBucketByIndex(a);if(this.$FBStoriesStore3(b))return 0;if(a===0){var c=this.$FBStoriesStore4(this.getUserBucketData());return c.length}if(a>0){c=this.$FBStoriesStore4(b);return c.length}return-1};d.getUnseenThreadIndex=function(a){return b("FBStoriesBucketHelper").getUnseenThreadIndex(this.getBucketByIndex(a))};d.getAllowedNavigationType=function(){var a=this.getSelectedBucketIndex(),c=a===0||a==1&&!b("FBStoriesBucketHelper").hasData(this.getUserBucketData());a=a===this.getBucketCount()-1;c=c&&this.getCurrentThreadIndexForSelectedBucket()==0;a=a&&this.getCurrentThreadIndexForSelectedBucket()===this.getThreadsForSelectedBucket().length-1;if(c)return"NEXT_ONLY";return a?"PREV_ONLY":"BOTH"};d.hasSeenBucketInCurrentSession=function(a){var b=this.getState().lastViewedThreadIndexForBucket;return b.get(a)!==void 0};d.getLastSeenThreadIndexForBucket=function(a){var b=this.getState().lastViewedThreadIndexForBucket;b=b.get(a);return b==void 0?0:b};d.$FBStoriesStore2=function(){return this.$FBStoriesStore4(this.getUserBucketData())};d.$FBStoriesStore1=function(){return this.getBucketByIndex(this.getSelectedBucketIndex())};d.getBucketByIndex=function(a){var b;return a===0?this.getUserBucketData():(b=this.getFriendsBucketData())!=null?b[a-1]:b};d.$FBStoriesStore8=function(a,b){b=this.$FBStoriesStore4(b);b=b.filter(function(b){return b.id===a});return b.length>0?b[0]:null};d.$FBStoriesStore4=function(a){return b("FBStoriesBucketHelper").getThreads(a)};d.$FBStoriesStore7=function(a){var c=this.getSelectedBucketOwner();a=this.getThreadsForSelectedBucket()[a];if(!a)return null;var d=b("FBStoriesThreadHelper").getMedia(a),e=b("FBStoriesThreadHelper").getWWWTextFormatMetadata(a),f=b("FBStoriesThreadHelper").getTextFormatMetadata(a),g=b("FBStoriesThreadHelper").getBackdropImage(a),h=b("FBStoriesThreadHelper").getMessageText(a),i=b("FBStoriesThreadHelper").getMessageRanges(a),j=b("FBStoriesThreadHelper").getDelightRanges(a),k=b("FBStoriesThreadHelper").getIsPlainText(a),l=b("FBStoriesThreadHelper").getOriginalPostStoryAttribution(a);return{isLive:!1,media:d,bucketOwner:c,threadOwner:b("FBStoriesThreadHelper").getOwner(a)||{name:null,id:null,is_viewer_friend:!1,profile_picture:null},participants:[],isSeen:b("FBStoriesThreadHelper").isSeenByViewer(a),latestMessageID:b("FBStoriesThreadHelper").getLatestMessageID(a),time:b("FBStoriesThreadHelper").getTime(a),threadID:b("FBStoriesThreadHelper").getId(a),cameraPostType:b("FBStoriesThreadHelper").getCameraPostType(a),cameraPostSource:b("FBStoriesThreadHelper").getCameraPostSource(a),wwwTextFormatMetadata:e,messageText:h,messageRanges:i,delightRanges:j,textFormatMetadata:f,backdropImage:g,isPlainText:k,originalPostStoryAttribution:l,activityDescription:b("FBStoriesThreadHelper").getActivityDescription(a),withTags:b("FBStoriesThreadHelper").getWithTags(a),explicitLocation:b("FBStoriesThreadHelper").getExplicitLocation(a),inlineActivities:b("FBStoriesThreadHelper").getInlineActivities(a),defaultBackground:b("FBStoriesThreadHelper").getDefaultBackground(a),linkAttachment:b("FBStoriesThreadHelper").getLinkAttachment(a),mediaBackground:b("FBStoriesThreadHelper").getMediaBackground(a),negativeFeedbackActions:b("FBStoriesThreadHelper").getNegativeFeedbackActions(a)}};d.getThreadDataForSelectedLiveBucket=function(){var a=this.$FBStoriesStore1();return this.$FBStoriesStore9(a)};d.$FBStoriesStore9=function(a){if(!a)return null;var c=b("FBStoriesBucketHelper").getLiveVideo(a);if(!c||!this.$FBStoriesStore3(a))return null;var d=this.getSelectedBucketOwner();return{isLive:!0,media:c,bucketOwner:d,isSeen:!1,cameraPostType:b("FBStoriesBucketHelper").getCameraPostType(a)}};d.isSelectedBucketLiveAndEnded=function(){return this.isSelectedBucketLive()&&b("FBStoriesBucketHelper").hasLiveVideoEnded(this.$FBStoriesStore1())};d.getIsCommercialBreakRunning=function(a){return!!this.getState().isCommercialBreakRunning.get(a)};d.getVideoMediaIdForBucketIndexAndThreadIndex=function(a,c){a=this.getBucketByIndex(a);if(!a)return null;if(this.$FBStoriesStore3(a)){var d=this.$FBStoriesStore9(a);return(d=d)!=null?(d=d.media)!=null?d.id:d:d}d=this.$FBStoriesStore4(a);if(c<0||c>=d.length)return null;a=b("FBStoriesThreadHelper").getMedia(d[c]);if(!a)return null;return!b("CameraPostMediaHelper").isVideo(a)?null:a.id};d.isViewerOpen=function(){return this.getState().isViewerOpen};d.getCurrentViewerEntrypoint=function(){return this.getState().viewerEntrypoint};d.getCurrentThreadOverlays=function(){return b("FBStoriesThreadHelper").getStoryOverlays(this.getCurrentThreadForSelectedBucket())};d.isProductionDialogLoading=function(){return this.getState().isProductionDialogLoading};return c}(b("FluxReduceStore"));a.__moduleID=e.id;c=new a(b("FBStoriesDispatcher"));e.exports=c}),null);
__d("FBStoriesMutedBucketOwnersActions",["CurrentUser","FBLogger","FBStoriesDataHelper","FBStoriesDispatcher","FBStoriesGraphQLAPI","FBStoriesMutedBucketOwnersActionTypes","FBStoriesMutedBucketOwnersStore","promiseDone"],(function(a,b,c,d,e,f){"use strict";var g=b("FBStoriesDispatcher").dispatch;a=function(){function a(){b("FBStoriesDispatcher").explicitlyRegisterStores([b("FBStoriesMutedBucketOwnersStore")])}var c=a.prototype;c.loadMutedOwners=function(){g({type:b("FBStoriesMutedBucketOwnersActionTypes").LOADING}),b("promiseDone")(b("FBStoriesGraphQLAPI").loadMutedBucketOwnersList(),function(a){g({type:b("FBStoriesMutedBucketOwnersActionTypes").LOADED,data:b("FBStoriesDataHelper").getMutedBucketOwnersFromLoadedQuery(a)})},function(){b("FBLogger")("fbstories").mustfix("failed to load muted bucket owners for: %s",b("CurrentUser").getID())})};c.setBucketOwnerMuted=function(a,c,d,e){b("promiseDone")(b("FBStoriesGraphQLAPI").muteBucketOwner(b("CurrentUser").getID(),a,e),function(){g({type:b("FBStoriesMutedBucketOwnersActionTypes").SET_IS_CURRENTLY_MUTING,ownerID:a,value:!1})},function(){b("FBLogger")("fbstories").mustfix("failed to mute bucket with owner id: %s",a)}),g({type:b("FBStoriesMutedBucketOwnersActionTypes").SET_IS_CURRENTLY_MUTING,ownerID:a,value:!0}),g({type:b("FBStoriesMutedBucketOwnersActionTypes").UPDATE_MUTED_OPTIMISTIC,ownerID:a,ownerName:c,ownerProfilePictureUri:d,value:e})};return a}();c=new a();e.exports=c}),null);
__d("FBStoriesActionsHelper",["FBStoriesStore","nullthrows"],(function(a,b,c,d,e,f){"use strict";f.checkAllBucketsViewed=i;f.resetNavMap=a;f.getNextBucketAndThreadIndex=c;var g={},h=function(a,c){var d=c?a+1:a-1,e=0,f=b("FBStoriesStore").getLastSeenThreadIndexForBucket(a),h=b("FBStoriesStore").hasSeenBucketInCurrentSession(a),j=g[a];if(!j)j={prev:null,next:null,curThreadIdx:f},g[a]=j;else{h&&(j.curThreadIdx=f);h=j.next!=null?g[j.next]:null;f=j.prev!=null?g[j.prev]:null;if(c&&h!=null&&h.curThreadIdx!=null){h.prev=a;return{nextBucketIndex:b("nullthrows")(j.next),nextThreadIndex:h.curThreadIdx}}else if(!c&&f!=null&&f.curThreadIdx!=null){f.next=a;return{nextBucketIndex:b("nullthrows")(j.prev),nextThreadIndex:f.curThreadIdx}}}h=!1;while(h===!1&&!i(d))e=b("FBStoriesStore").getUnseenThreadIndex(d),h=e>=0,h||(d=c?d+1:d-1);if(h){c?b("nullthrows")(j).next=d:b("nullthrows")(j).prev=d;f=g[d];f||(g[d]={prev:null,next:null,curThreadIdx:e},f=g[d]);c?b("nullthrows")(f).prev=a:b("nullthrows")(f).next=a}return{nextBucketIndex:d,nextThreadIndex:e}};function i(a){var c=b("FBStoriesStore").getBucketCount();return a>=c||a<0}function a(){g={}}function c(a,c){var d=c?a+1:a-1,e=0;if(b("FBStoriesStore").isUnseenMode()){a=h(a,c);d=a.nextBucketIndex;e=a.nextThreadIndex}else c||(e=b("FBStoriesStore").getLastSeenThreadIndexForBucket(d));return{nextBucketIndex:d,nextThreadIndex:e}}}),null);
__d("FBStoriesDataHelper",["CameraPostTypesHelper","CurrentUser","FBLogger","FBStoriesActions","FBStoriesActionTypes","FBStoriesBucketHelper","FBStoriesDispatcher","FBStoriesGating","FBStoriesGraphQLAPI","dotAccess","friendsBucketSorter","promiseDone"],(function(a,b,c,d,e,f){"use strict";f.getBucketsDataFromLoadedObject=g;f.hasData=a;f.getFriendsBucketDataFromLoadedObject=h;f.getUserDataNodesFromLoadedObject=i;f.getUserInfoFromLoadedObject=j;f.getFriendsDataWithEndedLiveBucket=c;f.getMutedBucketOwnersFromLoadedQuery=d;f.loadData=e;f.loadPageBucketData=k;function g(a){var c=i(a);c=c[0];var d=j(a);a=h(a);a=a.reduce(function(a,c){var d=b("FBStoriesBucketHelper").getThreads(c);d=d&&d.length>0;var e=b("FBStoriesBucketHelper").getCameraPostType(c),f=b("CameraPostTypesHelper").isStoryNux(e),g=b("CameraPostTypesHelper").isStory(e),h=b("CameraPostTypesHelper").isEventStory(e),i=b("CameraPostTypesHelper").isPageStory(e),j=b("CameraPostTypesHelper").isGroupStory(e);e=b("CameraPostTypesHelper").isBirthdayStory(e);if(f)return a;if(!d)return b("FBStoriesBucketHelper").isLive(c)?a.concat([c]):a;return g||i||h||j||e?a.concat([c]):a},[]);var e=b("FBStoriesGating").shouldUseTrayMigration();e||a.sort(b("friendsBucketSorter")(d.userID));return{userInfo:d,userBucketData:c,friendsBucketData:a}}function a(a){return!a?!1:h(a).length>0&&i(a).length>0}function h(a){var c=b("FBStoriesGating").shouldUseTrayMigration();if(c){return((c=a)!=null?(c=c.me)!=null?(c=c.unified_stories_buckets)!=null?c.nodes:c:c:c)||[]}return((c=a)!=null?(c=c.me)!=null?(c=c.friends_stories_buckets)!=null?c.nodes:c:c:c)||[]}function i(a){return((a=a)!=null?(a=a.me)!=null?(a=a.story_bucket)!=null?a.nodes:a:a:a)||[]}function j(a){var b;return{userName:(b=a)!=null?(b=b.me)!=null?b.name:b:b,userID:(b=a)!=null?(b=b.me)!=null?b.id:b:b,userGender:(b=a)!=null?(b=b.me)!=null?b.gender:b:b,userProfilePic:(b=a)!=null?(b=b.me)!=null?b.profile_picture:b:b}}function c(a,c,d){if(!c||d||!b("FBStoriesBucketHelper").isLive(c))return a;var e=b("FBStoriesBucketHelper").getId(c);d=!1;a=a.reduce(function(a,f){if(b("FBStoriesBucketHelper").getId(f)===e){d=!0;var g=!b("FBStoriesBucketHelper").isLive(f);c&&g&&(b("FBStoriesBucketHelper").setLiveVideo(f,c.live_video),b("FBStoriesBucketHelper").setHasLiveVideoEnded(f,!0))}a.push(f);return a},[]);d||(b("FBStoriesBucketHelper").setHasLiveVideoEnded(c,!0),a=[c].concat(a));return a}function d(a){a=((a=a)!=null?(a=a.me)!=null?(a=a.unfollowees_for_camera_post_story)!=null?a.edges:a:a:a)||[];return a.map(function(a){var b,c,d;a=a.node;d=(d=a)!=null?d.id:d;c=(c=a)!=null?c.name:c;b=(b=a)!=null?(b=b.profile_picture)!=null?b.uri:b:b;a=(a=a)!=null?(a=a.cover_photo)!=null?(a=a.photo)!=null?(a=a.image)!=null?a.uri:a:a:a:a;return{id:d,name:c,profilePictureUri:a?a:b,muted:!0}})}function e(a){b("promiseDone")(b("FBStoriesGraphQLAPI").load(),function(a){a=g(a);b("FBStoriesDispatcher").dispatch({type:b("FBStoriesActionTypes").LOADED,data:a})},a?a:function(a){a=a.errors;a.length>0&&a[0].message&&b("FBLogger")("fbstories").mustfix("Error loading user tray data, err msg: %s",a[0].message)})}function k(a,c){b("promiseDone")(b("FBStoriesGraphQLAPI").loadPageBucketStoryData(a),function(a){a=b("dotAccess")(a,"node.page_story_bucket.nodes");(a||a.length>0)&&(b("FBStoriesActions").resetStore(),b("FBStoriesActions").loadData(b("CurrentUser").getName(),b("CurrentUser").getID(),null,null,[babelHelpers["extends"]({},a[0])]))},c?c:function(c){c=c.errors;c.length>0&&c[0].message&&b("FBLogger")("fbstories").mustfix("Error loading page story data, page id: %s, err msg: %s",a,c[0].message)})}}),null);
__d("FBStoriesLoggingHelper",["Banzai","DirectMessagingTypedLogger","FBLogger","FBStoriesBucketHelper","FBStoriesLoggingConstants","FBStoriesStore","uuid"],(function(a,b,c,d,e,f){"use strict";var g=null,h={_traySessionID:null,_viewerSessionID:null,_eventStartTimes:{},logStoryTrayLoad:function(a){this._traySessionID=b("uuid")();var c=a.userBucketData;a=a.friendsBucketData;var d=b("FBStoriesBucketHelper").hasData(c),e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=new Map();b("FBStoriesBucketHelper").isLive(c)&&g++;a.forEach(function(a){e++;b("FBStoriesBucketHelper").getUnseenCount(a)>0&&f++;b("FBStoriesBucketHelper").isLive(a)&&g++;var c=b("FBStoriesBucketHelper").getLoggingType(a);switch(c){case b("FBStoriesLoggingConstants").PAGE_STORY:h++;break;case b("FBStoriesLoggingConstants").EVENT_STORY:i++;break;case b("FBStoriesLoggingConstants").GROUP_STORY:j++;break;case b("FBStoriesLoggingConstants").STORY_PROMOTION:k++;break;case b("FBStoriesLoggingConstants").FOLLOWEE_STORY:l++;break;case b("FBStoriesLoggingConstants").FRIEND_STORY:m++;break;default:b("FBLogger")("fbstories").mustfix("storyOwnerType not found: %s",c)}c=b("FBStoriesBucketHelper").getOwnerId(a);var d=b("FBStoriesBucketHelper").getThreadIDs(a);if(b("FBStoriesBucketHelper").isLive(a)){a=(a=b("FBStoriesBucketHelper").getLiveVideo(a))!=null?a.id:a;a&&d.push(a)}n.set(c,d)});this._getLogger().setName(b("FBStoriesLoggingConstants").ACTION_TRAY_LOAD).setHasMyStory(d).setNumberStories(e).setNumberNewStories(f).setNumberLiveStories(g).setLiveStoriesInTray(g).setPageStoriesInTray(h).setGroupStoriesInTray(j).setEventStoriesInTray(i).setFolloweeStoriesInTray(l).setFriendStoriesInTray(m).setPromotionStoriesInTray(k).setClientStoryThreadIds(n).setTraySessionID(this._traySessionID).log()},storyLog:function(a,c,d){g==null&&(g=c);a===b("FBStoriesLoggingConstants").ACTION_OPEN_STORY&&!this._viewerSessionID&&(this._viewerSessionID=b("uuid")());var e=b("FBStoriesStore").getSelectedBucketCameraPostType(),f=b("FBStoriesStore").getSelectedBucketOwnerID(),h=b("FBStoriesStore").getSelectedBucketOwnerType(),i=b("FBStoriesStore").getThreadCountForSelectedBucket(),j=b("FBStoriesStore").getSelectedBucketUnseenCount()>0,k=b("FBStoriesStore").getSelectedBucketIndex();e=this._getLogger().setCameraPostType(e).setName(a).setSource(c==null?g:c).setStoryOwner(f).setStoryOwnerType(h).setThreadCount(i).setHasNewContent(j).setStoryIndex(k).setTraySessionID(this._traySessionID).setClientViewerSessionID(this._viewerSessionID).setTrackingString(d);e.log();b("Banzai").post("stories_interaction_poseidon_logging_banzai",{name:a,source:c,story_owner:String(f),number_media:String(i)})},storyInsightsLog:function(a){b("Banzai").post("fb_stories_insights_logging_banzai",a.getData())},getLoggingMediaType:function(a){var b="unknown";a==="Photo"?b="photo":a==="Video"?b="video":a==="live"&&(b="live");return b},getMediaLogger:function(a,c,d){d=d||{cameraPostType:b("FBStoriesStore").getCurrentThreadCameraPostTypeForSelectedBucket(),storyOwnerFbid:b("FBStoriesStore").getSelectedBucketOwnerID(),storyOwnerType:b("FBStoriesStore").getSelectedBucketOwnerType(),mediaID:b("FBStoriesStore").getCurrentThreadMediaIDForSelectedBucket(),mediaType:b("FBStoriesStore").getCurrentThreadMediaTypeForSelectedBucket(),viewers:b("FBStoriesStore").getCurrentThreadMediaViewerCountForSelectedBucket(),bucketIndex:b("FBStoriesStore").getSelectedBucketIndex(),threadIndex:b("FBStoriesStore").getCurrentThreadIndexForSelectedBucket(),threadID:b("FBStoriesStore").getCurrentThreadIDForSelectedBucket(),threadCount:b("FBStoriesStore").getThreadCountForSelectedBucket()};var e=d.cameraPostType,f=d.storyOwnerFbid,g=d.storyOwnerType,h=d.mediaID,i=d.mediaType,j=d.viewers,k=d.bucketIndex,l=d.threadIndex,m=d.threadID;d=d.threadCount;m=m?m.toString():"";i=this.getLoggingMediaType(i);c=c||b("FBStoriesLoggingConstants").SOURCES.UNKNOWN;return this._getLogger().setCameraPostType(e).setName(a).setSource(c).setStoryOwner(f).setStoryOwnerType(g).setMediaType(i).setClientMediaID(h).setNumberViewers(j).setCardID(m).setStoryIndex(k).setMediaIndex(l).setNumberMedia(d).setTraySessionID(this._traySessionID).setClientViewerSessionID(this._viewerSessionID).setExtraClientData(JSON.stringify({story_size:d}))},mediaLog:function(a,b,c){this.getMediaLogger(a,b,c).log()},_getLogger:function(){return new(b("DirectMessagingTypedLogger"))()},openMediaLog:function(a,c){var d=b("FBStoriesStore").getFeedTrackingData(b("FBStoriesLoggingConstants").ACTION_OPEN_MEDIA);b("Banzai").post("stories_www_vpv_banzai",{media_id:b("FBStoriesStore").getCurrentThreadMediaIDForSelectedBucket(),owner_id:b("FBStoriesStore").getSelectedBucketOwnerID()});b("Banzai").post("fb_stories_banzai_generic",{ft:d});h.mediaLog(b("FBStoriesLoggingConstants").ACTION_OPEN_MEDIA,a,c)},deleteMediaLog:function(){h.mediaLog(b("FBStoriesLoggingConstants").ACTION_DELETE_MEDIA)},openSeenSummaryLog:function(){h.mediaLog(b("FBStoriesLoggingConstants").ACTION_OPEN_SEEN_SUMMARY)},storyNavigationLog:function(a){a=h.getMediaLogger(b("FBStoriesLoggingConstants").ACTION_STORY_NAVIGATION).setGesture(a);a.log();h.storyInsightsLog(a)},closeStoryLog:function(a,c){var d=b("FBStoriesLoggingConstants").ACTION_CLOSE_STORY;a=h.getMediaLogger(b("FBStoriesLoggingConstants").ACTION_CLOSE_STORY).setGesture(a).setActionSource(c);a.log();h.storyInsightsLog(a);a=b("FBStoriesStore").getSelectedBucketOwnerID();var e=b("FBStoriesStore").getThreadCountForSelectedBucket();b("Banzai").post("stories_interaction_poseidon_logging_banzai",{name:d,source:c,story_owner:String(a),number_media:String(e)});this._viewerSessionID=null}};e.exports=h}),null);
__d("FBStoriesPrefetcher",["Bootloader","FBStoriesActionsHelper","FBStoriesStore"],(function(a,b,c,d,e,f){"use strict";f.prefetchForCurrentThreadAndBucket=a;f.prefetch=c;f._prefetchVideos=d;f._prefetchForwardVideo=e;f._prefetchBackwardsVideo=g;f._prefetchVideo=h;f._prefetchThreadVideo=i;function a(){this.prefetch(b("FBStoriesStore").getSelectedBucketIndex(),b("FBStoriesStore").getCurrentThreadIndexForSelectedBucket())}function c(a,b){this._prefetchVideos(a,b)}function d(a,b){this._prefetchThreadVideo(a,b),this._prefetchForwardVideo(a,b),this._prefetchBackwardsVideo(a,b)}function e(a,b){this._prefetchVideo(!0,a,b)}function g(a,b){this._prefetchVideo(!1,a,b)}function h(a,c,d){var e=b("FBStoriesStore").getThreadCount(c);d=a?d+1:d-1;while(d>=0&&d<e){if(this._prefetchThreadVideo(c,d))return!0;d=a?d+1:d-1}d=c;while(!b("FBStoriesActionsHelper").checkAllBucketsViewed(d)){e=b("FBStoriesActionsHelper").getNextBucketAndThreadIndex(d,a);c=e.nextBucketIndex;e=e.nextThreadIndex;if(this._prefetchThreadVideo(c,e))return!0;d=c}return!1}function i(a,c){var d=b("FBStoriesStore").getVideoMediaIdForBucketIndexAndThreadIndex(a,c);if(!d)return!1;b("Bootloader").loadModules(["VideoPlayerMetaData"],function(a){a.genVideoData(d,{allowDashPrefetch:!0,forceHD:!0})},"FBStoriesPrefetcher");return!0}}),null);